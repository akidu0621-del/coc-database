<html lang="ja" class="dark" style="--simple-col-min: 80px; --simple-icon-size: 70px; --simple-font-size: 0.7rem;"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ã‚ãã¥å“ æ¢ç´¢è€…ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');
        
        :root {
            /* èƒŒæ™¯è‰²å¤‰æ•°ã‚’æ–¹çœ¼ç´™ã®ãƒ™ãƒ¼ã‚¹è‰²ã«å¤‰æ›´ */
            --bg-main: #ffffff; 
            --bg-card: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
            --accent-color: #6366f1;
            --bg-panel: #f8fafc; /* ãƒ‘ãƒãƒ«èƒŒæ™¯è‰²ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¿½åŠ  */
            
            /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ç”¨ã®å‹•çš„å¤‰æ•° (PCãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ) */
            --simple-col-min: 100px;
            --simple-icon-size: 80px;
            --simple-font-size: 0.8rem;
        }

        .dark {
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border-color: #334155;
            --accent-color: #818cf8;
            --bg-panel: #334155; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ™‚ã®ãƒ‘ãƒãƒ«èƒŒæ™¯è‰²ã‚’è¿½åŠ  */
        }

        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ç”¨ã®ãƒ†ã‚­ã‚¹ãƒˆè‰²å¼·åˆ¶ã‚¯ãƒ©ã‚¹ (è¿½åŠ ) */
        .dark .force-dark-text { color: #e2e8f0 !important; }
        .dark .force-dark-text-muted { color: #94a3b8 !important; }
        .dark .force-dark-text-white { color: #ffffff !important; }

        body { 
            font-family: 'Noto Sans JP', sans-serif; 
            background-color: var(--bg-main) !important;
            color: var(--text-main); 
            transition: background-color 0.3s, color 0.3s;
            min-height: 100vh;
            /* ã‚¹ãƒãƒ›ã§ã®æ¨ªæºã‚Œé˜²æ­¢ */
            overflow-x: hidden;

            /* --- æ–¹çœ¼ç´™ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¨­å®š --- */
            background-image: 
                linear-gradient(rgba(203, 213, 225, 0.4) 1px, transparent 1px),
                linear-gradient(90deg, rgba(203, 213, 225, 0.4) 1px, transparent 1px);
            background-size: 20px 20px;
            background-attachment: fixed; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã‚‚èƒŒæ™¯ã‚’å›ºå®š */
        }

        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ™‚ã®æ–¹çœ¼ç´™ãƒ‘ã‚¿ãƒ¼ãƒ³ */
        body.dark {
            background-image: 
                linear-gradient(rgba(51, 65, 85, 0.4) 1px, transparent 1px),
                linear-gradient(90deg, rgba(51, 65, 85, 0.4) 1px, transparent 1px);
        }

        /* --- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ (ã‚¹ãƒãƒ›å‘ã‘èª¿æ•´) --- */
        @media (max-width: 768px) {
            :root {
                /* ã‚¹ãƒãƒ›ã§ã¯å°‘ã—å°ã•ãã—ã¦4åˆ—è¡¨ç¤ºã‚’ç›®æŒ‡ã™ */
                --simple-col-min: 75px; 
                --simple-icon-size: 55px;
                --simple-font-size: 0.65rem;
            }
            
            /* å…¨ä½“ã®ä½™ç™½ã‚’è©°ã‚ã‚‹ */
            body { padding: 1rem 0.5rem !important; }
            
            /* ã‚¿ã‚¤ãƒˆãƒ«ã‚µã‚¤ã‚ºèª¿æ•´ */
            h1 { font-size: 1.5rem !important; margin-bottom: 1rem !important; text-align: center; }
            
            /* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®èª¿æ•´ */
            #normalToolbar { 
                gap: 0.5rem; 
                justify-content: flex-start; /* å·¦å¯„ã›ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã•ã›ã‚‹æ‰‹ã‚‚ã‚ã‚‹ãŒä»Šå›ã¯æŠ˜ã‚Šè¿”ã— */
            }
            .view-btn, .filter-btn, #collapseBtn, #lockBtn, #btn-save-json {
                font-size: 0.7rem !important;
                padding: 0.25rem 0.5rem !important;
            }
            
            /* æ¤œç´¢ãƒãƒ¼: iOSç­‰ã§å‹æ‰‹ã«ã‚ºãƒ¼ãƒ ã—ãªã„ã‚ˆã†ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºç¢ºä¿ */
            #searchInput { font-size: 16px !important; padding: 0.5rem !important; }
            
            /* çµ±è¨ˆã‚°ãƒªãƒƒãƒ‰: 8åˆ—ã¯ç„¡ç†ãªã®ã§4åˆ—ã«æŠ˜ã‚Šè¿”ã— */
            .stat-main-grid { 
                grid-template-columns: repeat(4, 1fr) !important; 
                gap: 8px !important; 
            }
            .stat-box { padding: 8px 2px !important; }
            .stat-val { font-size: 1.1rem !important; } /* å°‘ã—å°ã•ã */
            
            /* ã‚«ãƒ¼ãƒ‰å†…ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°èª¿æ•´ */
            .card .header-section { padding: 1.5rem 1rem !important; }

            /* è¿½åŠ : ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§ã®ã‚«ãƒ¼ãƒ‰ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ç¸®å°(ã¯ã¿å‡ºã—é˜²æ­¢) */
            body.view-mode-simple:not(.focused-mode) .card {
                padding: 4px !important;
            }
            
            /* ã‚¢ã‚¤ã‚³ãƒ³ãƒ¢ãƒ¼ãƒ‰ã®ã‚°ãƒªãƒƒãƒ‰å¹…èª¿æ•´: ã‚¹ãƒãƒ›ã§ã¯å¼·åˆ¶çš„ã«1åˆ—è¡¨ç¤º */
            body.view-mode-icons:not(.focused-mode) #characterList {
                grid-template-columns: 1fr !important;
            }
            
            /* ãƒ¢ãƒ¼ãƒ€ãƒ«å¹… */
            .modal-box { max-width: 95% !important; }

            /* --- è©³ç´°è¡¨ç¤ºãƒ»ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®ã‚¹ãƒãƒ›ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®æ­£ (ãƒœãƒ¼ãƒ€ãƒ¼ãƒ¬ã‚¹åŒ–) --- */
            body.view-mode-list .card, body.focused-mode .card.is-focused {
                /* æ ç·šã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®å•é¡Œã‚’è§£æ¶ˆ */
                border: none !important;
                
                /* ç¸¦ç©ã¿ */
                flex-direction: column !important; 
                height: auto !important;
                
                /* æ ç·šãŒãªã„ã®ã§ã‚·ãƒ£ãƒ‰ã‚¦ã§æµ®ãä¸ŠãŒã‚‰ã›ã‚‹ */
                box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.15), 0 5px 15px -5px rgba(0, 0, 0, 0.1) !important;
                
                /* ã‚¹ãƒãƒ›è©³ç´°è¡¨ç¤ºæ™‚ã«è§’ä¸¸ã‚’æœ‰åŠ¹ã«ã™ã‚‹ */
                overflow: hidden !important; 
                border-radius: 1.5rem !important;
                /* ã‚¹ãƒãƒ›ã§ã®æç”»ãƒã‚°å¯¾ç­– */
                transform: translateZ(0);
                /* è¿½åŠ : Safariç­‰ã§ã®ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°æ¼ã‚Œé˜²æ­¢ */
                -webkit-mask-image: -webkit-radial-gradient(white, black);
            }

            body.view-mode-list .card .header-section, 
            body.focused-mode .card .header-section {
                width: 100% !important;
                /* ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã®å¢ƒç•Œç·šã‚‚å‰Šé™¤ */
                border: none !important;
                
                flex-direction: column !important; /* ãƒ˜ãƒƒãƒ€ãƒ¼å†…ã‚‚ç¸¦ç©ã¿ */
                align-items: center !important;
                text-align: center !important;
                padding: 2.5rem 1.5rem 2rem 1.5rem !important; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°èª¿æ•´ */
                gap: 1rem !important;
                
                /* è§’ä¸¸ã‚„ãƒãƒ¼ã‚¸ãƒ³ã®ãƒãƒƒã‚¯ã¯å…¨ã¦è§£é™¤ï¼ˆè¦ªã®overflow:hiddenã«ä»»ã›ã‚‹ï¼‰ */
                border-radius: 0 !important;
                margin: 0 !important;
            }

            body.view-mode-list .card .image-preview, 
            body.focused-mode .card .image-preview {
                width: 120px !important;
                height: 120px !important;
                border-radius: 50% !important;
                aspect-ratio: 1/1 !important;
                margin-bottom: 0.5rem !important;
                margin-right: 0 !important;
                
                /* ãƒ˜ãƒƒãƒ€ãƒ¼ä¸Šã®ç”»åƒãƒœãƒ¼ãƒ€ãƒ¼ã‚‚å°‘ã—ã‚·ãƒ³ãƒ—ãƒ«ã« */
                border-width: 3px !important;
            }

            body.view-mode-list .info-container,
            body.focused-mode .info-container {
                width: 100% !important;
                align-items: center !important; /* ä¸­å¤®æƒãˆ */
            }

            body.view-mode-list .tags-wrapper,
            body.focused-mode .tags-wrapper {
                justify-content: center !important;
                flex-wrap: wrap !important;
            }

            body.view-mode-list .card .detail-section, 
            body.focused-mode .card .detail-section {
                padding: 1.5rem 1rem !important; /* è©³ç´°éƒ¨åˆ†ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ç¸®å° */
                width: 100% !important;
            }
            /* ---------------------------------------------------- */
        }

        /* --- é–²è¦§å°‚ç”¨ãƒ¢ãƒ¼ãƒ‰æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ«åˆ¶å¾¡ --- */
        body.readonly-view .admin-only,
        body.readonly-view #dropZone,
        body.readonly-view #btn-save-json,
        body.readonly-view #btn-export-html,
        body.readonly-view #btn-export-web,
        body.readonly-view #btn-compress-img,
        body.readonly-view #lockBtn {
            display: none !important;
        }
        
        body.readonly-view .image-preview,
        .readonly-mode .image-preview {
            pointer-events: none !important;
            cursor: default !important;
        }
        /* ----------------------------------- */

        .dark .stats-card { background-color: #1e293b; border-color: #475569; }
        .dark #collapseBtn { color: #e2e8f0 !important; background-color: #1e293b !important; border: 1px solid #475569; }
        #collapseBtn { color: #64748b; background-color: #f1f5f9; }

        .dark select, .dark option, .dark input[type="text"] {
            background-color: #1e293b !important;
            color: #ffffff !important;
            border-color: #475569 !important;
        }

        .dark #dropZone p, .dark #dropZone i { color: #e2e8f0 !important; }
        .dark #dropZone .text-slate-400 { color: #cbd5e1 !important; }

        .admin-only { transition: all 0.2s; }
        .readonly-mode .admin-only:not(.persistent) { display: none !important; }

        /* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .card { 
            background: var(--bg-card); 
            border-radius: 1.5rem; 
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 10px 15px -3px rgba(0,0,0,0.05); 
            overflow: hidden; 
            position: relative; 
            border: 2px solid var(--border-color); 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            max-width: 100%; /* ã¯ã¿å‡ºã—é˜²æ­¢ */
        }

        .card.lost-mode { background-color: #f1f5f9; border-color: #94a3b8 !important; }
        .dark .card.lost-mode { background-color: #020617; border-color: #475569 !important; }
        .card.lost-mode .image-preview { filter: grayscale(100%); opacity: 0.8; }
        
        .lost-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 4rem; font-weight: 900; color: rgba(0,0,0,0.1); pointer-events: none; z-index: 40;
            border: 6px solid rgba(0,0,0,0.1); padding: 0.5rem 2rem; border-radius: 1rem;
            white-space: nowrap; display: none;
        }
        .dark .lost-watermark { color: rgba(255,255,255,0.15); border-color: rgba(255,255,255,0.15); }
        .card.lost-mode .lost-watermark { display: block; }
        .card.lost-mode .header-section { opacity: 0.8; }

        /* --- ãƒ¢ãƒ¼ãƒ‰åˆ¥ã‚¹ã‚¿ã‚¤ãƒ« --- */
        
        /* 0. ã‚·ãƒ³ãƒ—ãƒ«è¡¨ç¤º (Simple) */
        body.view-mode-simple:not(.focused-mode) #characterList {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(var(--simple-col-min), 1fr));
            gap: 0.5rem;
        }
        body.view-mode-simple:not(.focused-mode) .card {
            cursor: pointer;
            border-left-width: 0 !important;
            border-bottom-width: 0 !important;
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            background: transparent;
            box-shadow: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem;
        }
        body.view-mode-simple:not(.focused-mode) .card:hover {
            background: var(--bg-card);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§éè¡¨ç¤ºã«ã™ã‚‹è¦ç´  */
        /* mt-4 (ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹) ã¯ã‚½ãƒ¼ãƒˆæ™‚ã«è¡¨ç¤ºã—ãŸã„ã®ã§ã“ã“ã‹ã‚‰ã¯é™¤å¤– */
        body.view-mode-simple:not(.focused-mode) .char-yomi,
        body.view-mode-simple:not(.focused-mode) .detail-section,
        body.view-mode-simple:not(.focused-mode) .tags-wrapper,
        body.view-mode-simple:not(.focused-mode) .mt-2,
        body.view-mode-simple:not(.focused-mode) .mt-1, /* èª•ç”Ÿæ—¥ãƒ»èº«é•·ä½“é‡è¡Œ */
        body.view-mode-simple:not(.focused-mode) .text-theme-muted,
        body.view-mode-simple:not(.focused-mode) .card-controls,
        body.view-mode-simple:not(.focused-mode) .lost-watermark
        { display: none !important; }

        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹(.mt-4)ã®ç‰¹åˆ¥ã‚¹ã‚¿ã‚¤ãƒ« */
        body.view-mode-simple:not(.focused-mode) .highlight-val-box {
            margin-top: 2px !important;
            padding: 1px 4px !important;
            border-radius: 4px !important;
            background-color: transparent !important;
            border: 1px solid var(--border-color) !important;
            min-height: auto !important;
        }
        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§ã¯ãƒ©ãƒ™ãƒ«ã‚’å°ã•ã */
        body.view-mode-simple:not(.focused-mode) .highlight-val-label {
            font-size: 0.6rem !important;
            margin-right: 4px !important;
        }
        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§ã¯å€¤ã‚’å°ã•ã */
        body.view-mode-simple:not(.focused-mode) .highlight-val-text {
            font-size: 0.8rem !important;
        }

        body.view-mode-simple:not(.focused-mode) .card .header-section {
            padding: 0 !important; width: 100%; border: none; background: transparent;
            display: flex; flex-direction: column; align-items: center;
        }
        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰æ™‚ã®æƒ…å ±ã‚³ãƒ³ãƒ†ãƒŠ: å·¦å¯„ã›ã‚’å¼·åˆ¶ */
        body.view-mode-simple:not(.focused-mode) .info-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start !important; /* ã‚¢ã‚¤ãƒ†ãƒ ã‚’å·¦å¯„ã› */
        }

        body.view-mode-simple:not(.focused-mode) .card .image-preview {
            width: var(--simple-icon-size);
            height: var(--simple-icon-size);
            border-radius: 50%;
            margin-bottom: 0.25rem;
            border: 2px solid var(--border-color);
            object-fit: cover;
        }
        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã®åå‰ - 1è¡Œè¡¨ç¤ºãƒ»çœç•¥ãƒ»å·¦å¯„ã› */
        body.view-mode-simple:not(.focused-mode) .char-name {
            font-size: var(--simple-font-size);
            margin: 0;
            text-align: left !important; /* å¼·åˆ¶å·¦å¯„ã› */
            width: 100%;
            /* 1è¡Œåˆ¶é™ã¨çœç•¥ */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
            height: auto;
            max-width: 100%;
            padding: 0 2px;
            
            font-weight: bold;
            color: var(--text-main);
        }
        body.view-mode-simple:not(.focused-mode) .card.lost-mode { opacity: 0.6; filter: grayscale(100%); }
        /* ä¿®æ­£: ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§ãƒ­ã‚¹ãƒˆæ™‚ã®åå‰ã®æ‰“ã¡æ¶ˆã—ç·šã‚’å‰Šé™¤ */
        body.view-mode-simple:not(.focused-mode) .card.lost-mode .char-name { text-decoration: none; }


        /* 1. ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º (Grid) */
        body.view-mode-icons:not(.focused-mode) #characterList { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1.5rem; 
        }
        body.view-mode-icons:not(.focused-mode) .card { 
            cursor: pointer; border-left-width: 0 !important; border-bottom-width: 8px !important; height: 100%; display: flex; flex-direction: column; overflow: hidden;
        }
        body.view-mode-icons:not(.focused-mode) .card .detail-section { display: none; }
        
        body.view-mode-icons:not(.focused-mode) .card .header-section { 
            padding: 3rem 1rem 1.5rem 1rem; 
            flex-direction: column; 
            text-align: center; 
            height: 100%; 
            display: flex; 
            align-items: center; 
            justify-content: flex-start;
            border-bottom: none; 
            width: 100%; 
            position: relative;
        }
        body.view-mode-icons:not(.focused-mode) .card .image-preview { 
            width: 120px; height: 120px; border-radius: 50%; margin-bottom: 1rem; border: 4px solid var(--bg-card); box-shadow: 0 4px 10px rgba(0,0,0,0.1); flex-shrink: 0;
        }
        body.view-mode-icons:not(.focused-mode) .info-container { 
            flex-direction: column; gap: 0.25rem; width: 100%; display: flex; align-items: center;
        }
        
        /* ã‚¢ã‚¤ã‚³ãƒ³ãƒ¢ãƒ¼ãƒ‰ã®åå‰ - 1è¡Œè¡¨ç¤ºã«å¼·åˆ¶å¤‰æ›´ */
        body.view-mode-icons:not(.focused-mode) .char-name { 
            font-size: 1.25rem; 
            margin-top: 0.25rem; 
            margin-bottom: 0.5rem; 
            width: 100%; 
            padding: 0 4px;
            
            /* 1è¡Œåˆ¶é™ */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
            height: auto;
            text-align: center;
        }
        
        body.view-mode-icons:not(.focused-mode) .tags-wrapper {
            flex-direction: column; gap: 0.5rem; width: 100%; flex-wrap: nowrap;
        }
        
        body.view-mode-icons:not(.focused-mode) .job-tag {
            max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; margin: 0 auto;
        }

        body.view-mode-icons:not(.focused-mode) .lost-watermark { font-size: 2rem; border-width: 3px; }

        /* 2. è©³ç´°è¡¨ç¤º (List) & ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰ */
        body.view-mode-list #characterList, body.focused-mode #characterList { 
            display: flex; flex-direction: column; gap: 2rem; 
        }
        
        /* å…±é€šã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ï¼šæ¨ªä¸¦ã³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body.view-mode-list .card, body.focused-mode .card.is-focused { 
            border-left-width: 14px !important; border-bottom-width: 2px !important; display: flex; flex-direction: row; align-items: stretch; cursor: default; width: 100%; 
            height: auto !important; min-height: 400px; overflow: visible !important;
        }
        body.focused-mode .card:not(.is-focused) { display: none; }

        body.view-mode-list .card .header-section, body.focused-mode .card .header-section { 
            width: 320px; flex-shrink: 0; display: flex; flex-direction: column; text-align: center; padding: 4rem 2rem 2rem 2rem; gap: 1.5rem; align-items: center; border-bottom: none; border-right: 1px dashed var(--border-color); background: rgba(0,0,0,0.01); height: auto; position: relative;
        }
        body.view-mode-list .card .image-preview, body.focused-mode .card .image-preview { 
            width: 100%; aspect-ratio: 3/4; height: auto; object-fit: cover; border-radius: 1.5rem; margin-bottom: 0.5rem; 
        }
        body.view-mode-list .card .detail-section, body.focused-mode .card .detail-section { 
            display: block !important; padding: 2.5rem 3rem; flex: 1; width: 100%; min-width: 0; position: relative; z-index: 10;
        }
        body.view-mode-list .info-container, body.focused-mode .info-container { display: flex; flex-direction: column; width: 100%; align-items: center; }
        body.view-mode-list .char-name, body.focused-mode .char-name { font-size: 2rem; line-height: 1.2; margin-bottom: 0.5rem; width: 100%; overflow-wrap: break-word; word-break: break-word; color: var(--text-main); }

        /* ä¸­é–“ã‚µã‚¤ã‚º (ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ) ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ (1024pxä»¥ä¸‹) */
        @media (max-width: 1024px) {
            body.view-mode-list .card, body.focused-mode .card.is-focused { flex-direction: column; }
            body.view-mode-list .card .header-section, body.focused-mode .card .header-section { width: 100%; border-right: none; border-bottom: 1px dashed var(--border-color); flex-direction: row; text-align: left; padding: 4rem 1.5rem 1.5rem 1.5rem; }
            body.view-mode-list .card .image-preview, body.focused-mode .card .image-preview { width: 100px; height: 100px; border-radius: 50%; aspect-ratio: 1/1; margin-bottom: 0; }
            .stat-main-grid { grid-template-columns: repeat(4, 1fr) !important; }
        }

        .card-controls { 
            position: absolute; top: 0.75rem; right: 0.75rem; display: flex; gap: 0.5rem; z-index: 900;
            background: rgba(255,255,255,0.85); backdrop-filter: blur(4px); padding: 6px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); flex-wrap: nowrap;
        }
        .dark .card-controls { background: rgba(15,23,42,0.85); border: 1px solid #334155; }
        
        .icon-btn {
            width: 2rem; height: 2rem; display: flex; align-items: center; justify-content: center;
            border-radius: 0.5rem; transition: all 0.2s; background-color: var(--bg-card);
            border: 1px solid var(--border-color); color: #94a3b8; cursor: pointer; pointer-events: auto !important;
        }
        .icon-btn:hover { border-color: currentColor; }

        .stat-main-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 12px; margin-bottom: 16px; }
        .stat-sub-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .stat-box { text-align: center; padding: 12px 4px; border-radius: 10px; border-width: 2px; border-style: solid; background: transparent; position: relative; }
        .stat-label { font-size: 0.75rem; color: var(--text-muted); display: block; font-weight: 800; line-height: 1.2; }
        .stat-val { font-size: 1.5rem; font-weight: 900; line-height: 1.2; color: var(--text-main); }
        .stat-sub-val { font-size: 0.75rem; color: var(--text-muted); font-weight: 600; display: block; margin-top: -2px; }
        
        .border-str { border-color: #fca5a5; color: #ef4444; }
        .border-con { border-color: #86efac; color: #22c55e; }
        .border-pow { border-color: #d8b4fe; color: #a855f7; }
        .border-dex { border-color: #fde047; color: #eab308; }
        .border-app { border-color: #f9a8d4; color: #ec4899; }
        .border-siz { border-color: #94a3b8; color: #64748b; }
        .border-int { border-color: #93c5fd; color: #3b82f6; }
        .border-edu { border-color: #fdba74; color: #f97316; }
        
        .border-hp { background-color: #fef2f2; border-color: #fca5a5; color: #b91c1c; }
        .dark .border-hp { background-color: rgba(220,38,38,0.2); }
        .border-mp { background-color: #eff6ff; border-color: #93c5fd; color: #1d4ed8; }
        .dark .border-mp { background-color: rgba(37,99,235,0.2); }
        .border-san { background-color: #ecfdf5; border-color: #86efac; color: #15803d; }
        .dark .border-san { background-color: rgba(5,150,105,0.2); }
        
        /* ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾ç­–ï¼‰ */
        .ranking-list-item {
            background-color: #f8fafc; /* slate-50 */
            border: 1px solid #e2e8f0; /* slate-200 */
            color: #1e293b;
            transition: all 0.2s;
        }
        .ranking-list-item:hover {
            background-color: #ffffff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .dark .ranking-list-item {
            background-color: #1e293b !important; /* slate-800 */
            border-color: #334155 !important; /* slate-700 */
            color: #f8fafc !important;
        }
        .dark .ranking-list-item:hover {
            background-color: #334155 !important; /* slate-700 */
        }

        /* ã‚¢ã‚¤ã‚³ãƒ³ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æ ç·šå¼·åŒ– */
        .image-preview {
            background-color: #000000; /* è¿½åŠ : é€éç”»åƒç”¨ã®é»’èƒŒæ™¯ */
            border: 4px solid #ffffff !important;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            transition: transform 0.2s;
            object-fit: cover;
            cursor: pointer;
        }
        .dark .image-preview {
            border-color: #ffffff !important; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚ãƒ˜ãƒƒãƒ€ãƒ¼èƒŒæ™¯ãŒã‚ã‚‹å ´åˆã¯ç™½æ ãŒåˆã† */
        }

        /* ã‚·ãƒ³ãƒ—ãƒ«ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯æ ç·šã‚’å°‘ã—æ§ãˆã‚ã« */
        body.view-mode-simple:not(.focused-mode) .card .image-preview {
            border: 3px solid var(--border-color) !important;
            box-shadow: none;
        }
        /* ã‚¢ã‚¤ã‚³ãƒ³ãƒ¢ãƒ¼ãƒ‰ã®ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ™‚å¾®èª¿æ•´ */
        .dark body.view-mode-icons:not(.focused-mode) .card .image-preview {
             border-color: rgba(255,255,255,0.9) !important;
        }


        .skill-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px; }
        .skill-item { 
            font-size: 0.75rem; background: var(--bg-panel); color: var(--text-main);
            padding: 6px 10px; border-radius: 8px; border-left: 3px solid #cbd5e1; 
            display: flex; justify-content: space-between; align-items: center; font-weight: bold; cursor: pointer; transition: all 0.2s; overflow: hidden;
        }
        .skill-item:hover { background: rgba(99, 102, 241, 0.1); border-left-color: #6366f1; }
        .dark .skill-item { background: rgba(255,255,255,0.05); }
        .skill-name { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-right: 4px; flex: 1; }

        .stats-card { background-color: var(--bg-card); padding: 2rem; border-radius: 2rem; border: 1px solid var(--border-color); color: var(--text-main); }
        .stats-header { font-weight: 900; margin-bottom: 1.5rem; display: flex; align-items: center; font-size: 1.125rem; color: var(--text-main); }
        .stats-sub-header { font-size: 0.6rem; font-weight: 900; display: block; margin-bottom: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); border-bottom: 1px solid var(--border-color); padding-bottom: 0.25rem; }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 1px; background: var(--border-color); border-radius: 12px; overflow: hidden; }
        .calendar-day { background: var(--bg-card); min-height: 70px; padding: 6px; font-size: 0.7rem; color: var(--text-sub); display: flex; flex-direction: column; overflow: hidden; }
        
        .bday-tag { 
            font-size: 0.6rem; font-weight: bold; background: rgba(99, 102, 241, 0.1); color: #6366f1; border-radius: 4px; padding: 2px 4px; margin-top: 2px; border-left-width: 3px; cursor: pointer; 
            overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 100%; display: block; 
        }

        .collapsible-content { transition: max-height 0.5s ease-in-out, opacity 0.3s ease; overflow: hidden; }
        .is-collapsed { max-height: 0 !important; opacity: 0; pointer-events: none; margin-bottom: 0 !important; }

        .edition-tag-6 { background-color: #60a5fa !important; color: white !important; }
        .edition-tag-7 { background-color: #4ade80 !important; color: white !important; }

        .crown-1 { color: #f59e0b; filter: drop-shadow(0 0 2px rgba(245, 158, 11, 0.5)); }
        .crown-2 { color: #94a3b8; }
        .crown-3 { color: #b45309; }

        .stat-item-pop { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0.75rem; background: var(--bg-panel); border-radius: 0.75rem; margin-bottom: 0.5rem; transition: transform 0.2s; color: var(--text-main); }
        .dark .stat-item-pop { background: rgba(255,255,255,0.08); color: #f8fafc; }

        /* ç·¨é›†å¯èƒ½ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ */
        .editable-field { cursor: pointer; border-bottom: 1px dashed transparent; min-width: 2px; display: inline-block; min-height: 1.2em; transition: all 0.2s; padding: 0 2px; }
        .editable-field:hover { background-color: rgba(99, 102, 241, 0.1); border-bottom-color: #6366f1; }
        .editable-field:empty { display: inline-block; min-width: 1em; border-bottom: 1px dotted transparent; }
        body:not(.readonly-mode) .editable-field:empty { border-bottom-color: #e2e8f0; }
        body:not(.readonly-mode) .editable-field:empty:hover { border-bottom-color: #6366f1; background-color: rgba(99, 102, 241, 0.05); }
        body:not(.readonly-mode) .editable-field:empty::before { content: ''; }
        body:not(.readonly-mode) .editable-field:empty:hover::before { content: 'ğŸ–Šï¸'; font-size: 0.8em; opacity: 0.5; }
        
        body.readonly-view .editable-field, .readonly-mode .editable-field { pointer-events: none !important; cursor: default !important; border-bottom: none !important; background: transparent !important; }
        body.readonly-view .editable-field:empty, .readonly-mode .editable-field:empty { display: none !important; }

        .modal-overlay { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(8px); display: none; position: fixed; inset: 0; z-index: 2147483647; align-items: center; justify-content: center; }
        .modal-box { background-color: #ffffff; color: #1e293b; border-radius: 1.5rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); border: 2px solid var(--border-color); position: relative; overflow: hidden; display: flex; flex-direction: column; }
        .dark .modal-box { background-color: #1e293b; color: #ffffff; border-color: #475569; }

        #rawTextArea { color: #334155 !important; background-color: #f8fafc !important; border: 1px solid #e2e8f0 !important; min-height: 400px; padding: 1rem; font-family: monospace; white-space: pre-wrap; overflow-y: auto; width: 100%; display: block; }
        html.dark #rawTextArea, .dark #rawTextArea { color: #ffffff !important; background-color: #020617 !important; border: 1px solid #475569 !important; }

        .sorting-by-skill .skill-item.active-sort { background: #6366f1 !important; color: white !important; border-left-color: #4338ca !important; }
        .color-picker-btn { -webkit-appearance: none; border: none; width: 32px; height: 32px; border-radius: 8px; cursor: pointer; padding: 0; overflow: hidden; pointer-events: auto !important; }
        .color-picker-btn::-webkit-color-swatch-wrapper { padding: 0; }
        .color-picker-btn::-webkit-color-swatch { border: none; }

        .view-btn.active { color: #6366f1; border-color: #6366f1; }
        .filter-btn.active { color: #6366f1; border-color: #6366f1; background-color: rgba(99, 102, 241, 0.1); }

        .pagination-container { display: flex; justify-content: center; align-items: center; gap: 1rem; margin-bottom: 2rem; margin-top: 1rem; }
        .page-btn { padding: 0.5rem 1rem; border-radius: 0.75rem; font-weight: bold; font-size: 0.85rem; background: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-muted); transition: all 0.2s; }
        .page-btn:hover:not(:disabled) { background: #6366f1; color: white; border-color: #6366f1; }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .page-btn.active { background: #6366f1; color: white; border-color: #6366f1; }
        
        .form-input { background-color: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-main); }
        .info-panel { background-color: var(--bg-panel); border: 1px solid var(--border-color); color: var(--text-sub); }
        
        /* ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚°ãƒªãƒƒãƒ‰ */
        .ranking-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
        @media (min-width: 768px) {
            .ranking-grid { grid-template-columns: repeat(4, 1fr); }
        }
        
        /* æŠ€èƒ½ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¶å¾¡ */
        body.view-mode-list .skill-section { display: none !important; }
        body.focused-mode .skill-section { display: block !important; margin-top: 2rem; }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.pointer-events-none{pointer-events:none}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.-bottom-4{bottom:-1rem}.-right-4{right:-1rem}.left-4{left:1rem}.right-4{right:1rem}.top-0{top:0px}.top-1\/2{top:50%}.top-4{top:1rem}.z-10{z-index:10}.z-50{z-index:50}.z-\[1000\]{z-index:1000}.mx-1{margin-left:0.25rem;margin-right:0.25rem}.mx-auto{margin-left:auto;margin-right:auto}.mx-0\.5{margin-left:0.125rem;margin-right:0.125rem}.-mt-1{margin-top:-0.25rem}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-20{margin-bottom:5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:0.25rem}.ml-auto{margin-left:auto}.mr-1{margin-right:0.25rem}.mr-2{margin-right:0.5rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.mb-3{margin-bottom:0.75rem}.ml-2{margin-left:0.5rem}.mr-0\.5{margin-right:0.125rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-6{height:1.5rem}.h-8{height:2rem}.h-full{height:100%}.h-1{height:0.25rem}.h-20{height:5rem}.max-h-\[80vh\]{max-height:80vh}.max-h-\[90vh\]{max-height:90vh}.min-h-\[10px\]{min-height:10px}.w-10{width:2.5rem}.w-8{width:2rem}.w-full{width:100%}.w-px{width:1px}.w-4{width:1rem}.min-w-\[280px\]{min-width:280px}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.max-w-7xl{max-width:80rem}.max-w-\[150px\]{max-width:150px}.max-w-sm{max-width:24rem}.max-w-full{max-width:100%}.flex-1{flex:1 1 0%}.flex-shrink-0{flex-shrink:0}.shrink-0{flex-shrink:0}.-translate-y-1\/2{--tw-translate-y:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.gap-1\.5{gap:0.375rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.text-ellipsis{text-overflow:ellipsis}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-\[2rem\]{border-radius:2rem}.rounded-full{border-radius:9999px}.rounded-xl{border-radius:0.75rem}.rounded-lg{border-radius:0.5rem}.rounded-l-xl{border-top-left-radius:0.75rem;border-bottom-left-radius:0.75rem}.rounded-r-xl{border-top-right-radius:0.75rem;border-bottom-right-radius:0.75rem}.border{border-width:1px}.border-2{border-width:2px}.border-4{border-width:4px}.border-b-2{border-bottom-width:2px}.border-t{border-top-width:1px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-dashed{border-style:dashed}.border-indigo-100{--tw-border-opacity:1;border-color:rgb(224 231 255 / var(--tw-border-opacity, 1))}.border-slate-100{--tw-border-opacity:1;border-color:rgb(241 245 249 / var(--tw-border-opacity, 1))}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-rose-300{--tw-border-opacity:1;border-color:rgb(253 164 175 / var(--tw-border-opacity, 1))}.bg-\[var\(--bg-main\)\]{background-color:var(--bg-main)}.bg-emerald-500{--tw-bg-opacity:1;background-color:rgb(16 185 129 / var(--tw-bg-opacity, 1))}.bg-indigo-500{--tw-bg-opacity:1;background-color:rgb(99 102 241 / var(--tw-bg-opacity, 1))}.bg-indigo-600{--tw-bg-opacity:1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.bg-orange-400{--tw-bg-opacity:1;background-color:rgb(251 146 60 / var(--tw-bg-opacity, 1))}.bg-rose-500{--tw-bg-opacity:1;background-color:rgb(244 63 94 / var(--tw-bg-opacity, 1))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-200{--tw-bg-opacity:1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-slate-700{--tw-bg-opacity:1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.bg-slate-900{--tw-bg-opacity:1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-indigo-100{--tw-bg-opacity:1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-indigo-400{--tw-bg-opacity:1;background-color:rgb(129 140 248 / var(--tw-bg-opacity, 1))}.bg-pink-100{--tw-bg-opacity:1;background-color:rgb(252 231 243 / var(--tw-bg-opacity, 1))}.bg-rose-100{--tw-bg-opacity:1;background-color:rgb(255 228 230 / var(--tw-bg-opacity, 1))}.bg-sky-100{--tw-bg-opacity:1;background-color:rgb(224 242 254 / var(--tw-bg-opacity, 1))}.p-1{padding:0.25rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.pb-4{padding-bottom:1rem}.pl-10{padding-left:2.5rem}.pr-4{padding-right:1rem}.pr-8{padding-right:2rem}.pt-4{padding-top:1rem}.pb-1{padding-bottom:0.25rem}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\[10px\]{font-size:10px}.text-\[9px\]{font-size:9px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-2xl{font-size:1.5rem;line-height:2rem}.font-black{font-weight:900}.font-bold{font-weight:700}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-tight{line-height:1.25}.tracking-tighter{letter-spacing:-0.05em}.tracking-widest{letter-spacing:0.1em}.text-indigo-200{--tw-text-opacity:1;color:rgb(199 210 254 / var(--tw-text-opacity, 1))}.text-indigo-400{--tw-text-opacity:1;color:rgb(129 140 248 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-rose-500{--tw-text-opacity:1;color:rgb(244 63 94 / var(--tw-text-opacity, 1))}.text-slate-300{--tw-text-opacity:1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.text-slate-500{--tw-text-opacity:1;color:rgb(100 116 139 / var(--tw-text-opacity, 1))}.text-slate-600{--tw-text-opacity:1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-slate-700{--tw-text-opacity:1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-pink-500{--tw-text-opacity:1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-pink-600{--tw-text-opacity:1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.text-rose-600{--tw-text-opacity:1;color:rgb(225 29 72 / var(--tw-text-opacity, 1))}.text-sky-500{--tw-text-opacity:1;color:rgb(14 165 233 / var(--tw-text-opacity, 1))}.text-sky-600{--tw-text-opacity:1;color:rgb(2 132 199 / var(--tw-text-opacity, 1))}.text-yellow-400{--tw-text-opacity:1;color:rgb(250 204 21 / var(--tw-text-opacity, 1))}.opacity-0{opacity:0}.opacity-20{opacity:0.2}.opacity-50{opacity:0.5}.opacity-80{opacity:0.8}.opacity-60{opacity:0.6}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:border-indigo-400:hover{--tw-border-opacity:1;border-color:rgb(129 140 248 / var(--tw-border-opacity, 1))}.hover\:bg-emerald-600:hover{--tw-bg-opacity:1;background-color:rgb(5 150 105 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-50:hover{--tw-bg-opacity:1;background-color:rgb(238 242 255 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-600:hover{--tw-bg-opacity:1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-700:hover{--tw-bg-opacity:1;background-color:rgb(67 56 202 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-500:hover{--tw-bg-opacity:1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.hover\:bg-rose-600:hover{--tw-bg-opacity:1;background-color:rgb(225 29 72 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-200:hover{--tw-bg-opacity:1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-600:hover{--tw-bg-opacity:1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.hover\:bg-white:hover{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-100:hover{--tw-bg-opacity:1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.hover\:text-indigo-500:hover{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.hover\:text-slate-600:hover{--tw-text-opacity:1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.hover\:text-rose-500:hover{--tw-text-opacity:1;color:rgb(244 63 94 / var(--tw-text-opacity, 1))}.hover\:text-rose-600:hover{--tw-text-opacity:1;color:rgb(225 29 72 / var(--tw-text-opacity, 1))}.hover\:shadow-md:hover{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.focus\:border-indigo-400:focus{--tw-border-opacity:1;border-color:rgb(129 140 248 / var(--tw-border-opacity, 1))}.group:hover .group-hover\:text-indigo-500{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 768px){.md\:gap-4{gap:1rem}.md\:p-8{padding:2rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}@media (min-width: 1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}@media (min-width: 1280px){.xl\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}@media (prefers-color-scheme: dark){.dark\:border-slate-700{--tw-border-opacity:1;border-color:rgb(51 65 85 / var(--tw-border-opacity, 1))}.dark\:border-slate-800{--tw-border-opacity:1;border-color:rgb(30 41 59 / var(--tw-border-opacity, 1))}.dark\:bg-slate-700{--tw-bg-opacity:1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.dark\:bg-slate-800{--tw-bg-opacity:1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.dark\:bg-slate-900{--tw-bg-opacity:1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.dark\:bg-slate-900\/50{background-color:rgb(15 23 42 / 0.5)}.dark\:text-indigo-400{--tw-text-opacity:1;color:rgb(129 140 248 / var(--tw-text-opacity, 1))}.dark\:text-slate-200{--tw-text-opacity:1;color:rgb(226 232 240 / var(--tw-text-opacity, 1))}.dark\:text-slate-300{--tw-text-opacity:1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.dark\:text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.dark\:text-slate-600{--tw-text-opacity:1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.dark\:hover\:bg-indigo-900:hover{--tw-bg-opacity:1;background-color:rgb(49 46 129 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-slate-600:hover{--tw-bg-opacity:1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-slate-800:hover{--tw-bg-opacity:1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-indigo-900\/30:hover{background-color:rgb(49 46 129 / 0.3)}}</style></head>
<body class="readonly-view p-4 md:p-8 dark focused-mode" id="mainBody">

    <div class="max-w-7xl mx-auto">
        <!-- Toolbar -->
        <div class="flex flex-wrap justify-between items-center mb-6 gap-4 sticky top-0 z-[1000] py-2 bg-[var(--bg-main)] transition-colors">
            <div class="flex items-center flex-wrap gap-2 md:gap-4 hidden" id="normalToolbar">
                <button onclick="setViewMode('simple')" id="btn-mode-simple" class="view-btn font-black py-2 border-b-2 transition-all border-transparent text-slate-400 hover:text-slate-600 force-dark-text-muted">ã‚·ãƒ³ãƒ—ãƒ«</button>
                <button onclick="setViewMode('icons')" id="btn-mode-icons" class="view-btn font-black py-2 border-b-2 transition-all border-transparent text-slate-400 hover:text-slate-600 force-dark-text-muted">ã‚¢ã‚¤ã‚³ãƒ³</button>
                <button onclick="setViewMode('list')" id="btn-mode-list" class="view-btn font-black py-2 border-b-2 transition-all border-transparent text-slate-400 hover:text-slate-600 force-dark-text-muted">è©³ç´°</button>
                <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1"></div>
                <button onclick="toggleCollapseList()" id="collapseBtn" class="px-3 py-1.5 rounded-xl text-xs font-black bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-300 hover:bg-indigo-50 dark:hover:bg-indigo-900 transition-all force-dark-text">
                    <i class="fas fa-compress-alt mr-1"></i>ä¸€è¦§ã‚’éš ã™
                </button>
                <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1"></div>
                <button onclick="toggleVersionFilter('6ç‰ˆ')" id="filter-6" class="filter-btn px-3 py-1.5 rounded-xl text-xs font-black border-2 transition-all border-transparent text-slate-400 hover:text-slate-600 force-dark-text-muted">6ç‰ˆ</button>
                <button onclick="toggleVersionFilter('7ç‰ˆ')" id="filter-7" class="filter-btn px-3 py-1.5 rounded-xl text-xs font-black border-2 transition-all border-transparent text-slate-400 hover:text-slate-600 force-dark-text-muted">7ç‰ˆ</button>
                <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1"></div>
                <select id="skillSelect" onchange="filterBySkill(this.value)" class="bg-transparent text-xs font-black outline-none cursor-pointer max-w-[150px] dark:text-slate-300 force-dark-text"><option value="">æŠ€èƒ½ã§æŠ½å‡ºãƒ»ã‚½ãƒ¼ãƒˆ...</option><option value="SIVA">SIVA</option><option value="ã‚¢ã‚¤ã‚¼ãƒ³">ã‚¢ã‚¤ã‚¼ãƒ³</option><option value="ã‚ªã‚«ãƒ«ãƒˆ">ã‚ªã‚«ãƒ«ãƒˆ</option><option value="ã‚­ãƒƒã‚¯">ã‚­ãƒƒã‚¯</option><option value="ã‚¯ãƒˆã‚¥ãƒ«ãƒ•ç¥è©±">ã‚¯ãƒˆã‚¥ãƒ«ãƒ•ç¥è©±</option><option value="ã‚²ãƒ¼ãƒˆãƒœãƒ¼ãƒ«">ã‚²ãƒ¼ãƒˆãƒœãƒ¼ãƒ«</option><option value="ã“ã¶ã—">ã“ã¶ã—</option><option value="ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼">ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼</option><option value="ã‚µãƒã‚¤ãƒãƒ«ï¼ˆã‚¸ãƒ£ãƒ³ã‚°ãƒ«ï¼‰">ã‚µãƒã‚¤ãƒãƒ«ï¼ˆã‚¸ãƒ£ãƒ³ã‚°ãƒ«ï¼‰</option><option value="ã‚µãƒã‚¤ãƒãƒ«ï¼ˆå±±å²³ï¼‰">ã‚µãƒã‚¤ãƒãƒ«ï¼ˆå±±å²³ï¼‰</option><option value="ã‚µãƒã‚¤ãƒãƒ«ï¼ˆæ´‹ä¸Šï¼‰">ã‚µãƒã‚¤ãƒãƒ«ï¼ˆæ´‹ä¸Šï¼‰</option><option value="ã‚µãƒ«ãƒ¼ã‚­">ã‚µãƒ«ãƒ¼ã‚­</option><option value="ã‚·ãƒ¥ãƒŠã‚¦ã‚¶ãƒ¼22">ã‚·ãƒ¥ãƒŠã‚¦ã‚¶ãƒ¼22</option><option value="ã‚·ãƒ§ãƒƒãƒˆã‚¬ãƒ³">ã‚·ãƒ§ãƒƒãƒˆã‚¬ãƒ³</option><option value="ãƒŠã‚¤ãƒ•">ãƒŠã‚¤ãƒ•</option><option value="ãƒŠã‚¤ãƒ•ï¼ˆãƒ¡ã‚¹ï¼‰">ãƒŠã‚¤ãƒ•ï¼ˆãƒ¡ã‚¹ï¼‰</option><option value="ãƒŠãƒ“ã‚²ãƒ¼ãƒˆ">ãƒŠãƒ“ã‚²ãƒ¼ãƒˆ</option><option value="ãƒ”ãƒƒã‚±ãƒ«">ãƒ”ãƒƒã‚±ãƒ«</option><option value="ã»ã‹ã®è¨€èªï¼ˆã‚µãƒ³ã‚¹ã‚¯ãƒªãƒƒãƒˆèªï¼‰">ã»ã‹ã®è¨€èªï¼ˆã‚µãƒ³ã‚¹ã‚¯ãƒªãƒƒãƒˆèªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆãƒ‰ã‚¤ãƒ„èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆãƒ‰ã‚¤ãƒ„èªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆãƒ•ãƒ©ãƒ³ã‚¹èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆãƒ•ãƒ©ãƒ³ã‚¹èªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆä¸­å›½èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆä¸­å›½èªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆæ—¥æœ¬èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆæ—¥æœ¬èªï¼‰</option><option value="ã»ã‹ã®è¨€èªï¼ˆçŒ«èªï¼‰">ã»ã‹ã®è¨€èªï¼ˆçŒ«èªï¼‰</option><option value="ãƒãƒ¼ã‚·ãƒ£ãƒ«ã‚¢ãƒ¼ãƒ„">ãƒãƒ¼ã‚·ãƒ£ãƒ«ã‚¢ãƒ¼ãƒ„</option><option value="æš—å™¨ï¼ˆãƒŠã‚¤ãƒ•ï¼‰">æš—å™¨ï¼ˆãƒŠã‚¤ãƒ•ï¼‰</option><option value="å¨åœ§">å¨åœ§</option><option value="åŒ»å­¦">åŒ»å­¦</option><option value="éš ã™">éš ã™</option><option value="éš ã‚Œã‚‹">éš ã‚Œã‚‹</option><option value="éš å¯†">éš å¯†</option><option value="é‹è»¢ï¼ˆã‚¹ã‚±ãƒœãƒ¼ï¼‰">é‹è»¢ï¼ˆã‚¹ã‚±ãƒœãƒ¼ï¼‰</option><option value="é‹è»¢ï¼ˆãƒã‚¤ã‚¯ï¼‰">é‹è»¢ï¼ˆãƒã‚¤ã‚¯ï¼‰</option><option value="é‹è»¢ï¼ˆãƒ­ãƒ¼ãƒ©ãƒ¼ãƒ–ãƒ¬ãƒ¼ãƒ‰ï¼‰">é‹è»¢ï¼ˆãƒ­ãƒ¼ãƒ©ãƒ¼ãƒ–ãƒ¬ãƒ¼ãƒ‰ï¼‰</option><option value="é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰">é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰</option><option value="é‹è»¢ï¼ˆè‡ªå‹•äºŒè¼ªï¼‰">é‹è»¢ï¼ˆè‡ªå‹•äºŒè¼ªï¼‰</option><option value="é‹è»¢ï¼ˆæ™®é€šäºŒè¼ªï¼‰">é‹è»¢ï¼ˆæ™®é€šäºŒè¼ªï¼‰</option><option value="å¿œæ€¥æ‰‹å½“">å¿œæ€¥æ‰‹å½“</option><option value="åŒ–å­¦">åŒ–å­¦</option><option value="ç§‘å­¦ï¼ˆåŒ–å­¦ï¼‰">ç§‘å­¦ï¼ˆåŒ–å­¦ï¼‰</option><option value="ç§‘å­¦ï¼ˆç”Ÿç‰©å­¦ï¼‰">ç§‘å­¦ï¼ˆç”Ÿç‰©å­¦ï¼‰</option><option value="ç§‘å­¦ï¼ˆåœ°è³ªå­¦ï¼‰">ç§‘å­¦ï¼ˆåœ°è³ªå­¦ï¼‰</option><option value="ç§‘å­¦ï¼ˆå‹•ç‰©å­¦ï¼‰">ç§‘å­¦ï¼ˆå‹•ç‰©å­¦ï¼‰</option><option value="ç§‘å­¦ï¼ˆç‰©ç†å­¦ï¼‰">ç§‘å­¦ï¼ˆç‰©ç†å­¦ï¼‰</option><option value="ç§‘å­¦ï¼ˆè–¬å­¦ï¼‰">ç§‘å­¦ï¼ˆè–¬å­¦ï¼‰</option><option value="å›é¿">å›é¿</option><option value="é‘‘å®š">é‘‘å®š</option><option value="æ©Ÿæ¢°ä¿®ç†">æ©Ÿæ¢°ä¿®ç†</option><option value="è¿‘æ¥æˆ¦é—˜ï¼ˆãƒ†ã‚³ãƒ³ãƒ‰ãƒ¼ï¼‰">è¿‘æ¥æˆ¦é—˜ï¼ˆãƒ†ã‚³ãƒ³ãƒ‰ãƒ¼ï¼‰</option><option value="è¿‘æ¥æˆ¦é—˜ï¼ˆæ ¼é—˜ï¼‰">è¿‘æ¥æˆ¦é—˜ï¼ˆæ ¼é—˜ï¼‰</option><option value="è¿‘æ¥æˆ¦é—˜ï¼ˆç©ºæ‰‹ï¼‰">è¿‘æ¥æˆ¦é—˜ï¼ˆç©ºæ‰‹ï¼‰</option><option value="è¿‘æ¥æˆ¦é—˜ï¼ˆè­·èº«è¡“ï¼‰">è¿‘æ¥æˆ¦é—˜ï¼ˆè­·èº«è¡“ï¼‰</option><option value="è¿‘æ¥æˆ¦é—˜ï¼ˆåˆæ°—é“ï¼‰">è¿‘æ¥æˆ¦é—˜ï¼ˆåˆæ°—é“ï¼‰</option><option value="è¿‘æ¥æˆ¦é—˜ï¼ˆåˆ€å‰£ï¼‰">è¿‘æ¥æˆ¦é—˜ï¼ˆåˆ€å‰£ï¼‰</option><option value="çµŒç†">çµŒç†</option><option value="èŠ¸è¡“ï¼ˆã‚ã‚„ã¨ã‚Šï¼‰">èŠ¸è¡“ï¼ˆã‚ã‚„ã¨ã‚Šï¼‰</option><option value="èŠ¸è¡“ï¼ˆã‚¤ã‚«ã‚µãƒï¼‰">èŠ¸è¡“ï¼ˆã‚¤ã‚«ã‚µãƒï¼‰</option><option value="èŠ¸è¡“ï¼ˆã‚«ãƒªã‚¹ãƒï¼‰">èŠ¸è¡“ï¼ˆã‚«ãƒªã‚¹ãƒï¼‰</option><option value="èŠ¸è¡“ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰">èŠ¸è¡“ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆãƒ€ãƒ³ã‚¹ï¼ˆå‰£èˆï¼‰ï¼‰">èŠ¸è¡“ï¼ˆãƒ€ãƒ³ã‚¹ï¼ˆå‰£èˆï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆãƒ€ãƒ³ã‚¹ï¼‰">èŠ¸è¡“ï¼ˆãƒ€ãƒ³ã‚¹ï¼‰</option><option value="èŠ¸è¡“ï¼ˆãƒ„ãƒƒã‚³ãƒŸï¼‰">èŠ¸è¡“ï¼ˆãƒ„ãƒƒã‚³ãƒŸï¼‰</option><option value="èŠ¸è¡“ï¼ˆãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆç”˜å£ï¼‰ï¼‰">èŠ¸è¡“ï¼ˆãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆç”˜å£ï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ï¼‰">èŠ¸è¡“ï¼ˆãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ï¼‰</option><option value="èŠ¸è¡“ï¼ˆãƒ¡ã‚¤ã‚¯ï¼‰">èŠ¸è¡“ï¼ˆãƒ¡ã‚¤ã‚¯ï¼‰</option><option value="èŠ¸è¡“ï¼ˆã‚†ã‚ã«ã£ãï¼ˆå¤¢èªã‚Šï¼‰ï¼‰">èŠ¸è¡“ï¼ˆã‚†ã‚ã«ã£ãï¼ˆå¤¢èªã‚Šï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆæš—æ®ºï¼‰">èŠ¸è¡“ï¼ˆæš—æ®ºï¼‰</option><option value="èŠ¸è¡“ï¼ˆæ¼”åŠ‡ï¼‰">èŠ¸è¡“ï¼ˆæ¼”åŠ‡ï¼‰</option><option value="èŠ¸è¡“ï¼ˆæ­Œå”±ï¼‰">èŠ¸è¡“ï¼ˆæ­Œå”±ï¼‰</option><option value="èŠ¸è¡“ï¼ˆçµµç”»ï¼‰">èŠ¸è¡“ï¼ˆçµµç”»ï¼‰</option><option value="èŠ¸è¡“ï¼ˆå£ç¬›ï¼‰">èŠ¸è¡“ï¼ˆå£ç¬›ï¼‰</option><option value="èŠ¸è¡“ï¼ˆå½©è‰²è¦‹ç¾ï¼ˆã•ã„ã—ã‚‡ãã‘ã‚“ã³ï¼‰ï¼‰">èŠ¸è¡“ï¼ˆå½©è‰²è¦‹ç¾ï¼ˆã•ã„ã—ã‚‡ãã‘ã‚“ã³ï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆå†™ç”Ÿï¼‰">èŠ¸è¡“ï¼ˆå†™ç”Ÿï¼‰</option><option value="èŠ¸è¡“ï¼ˆæ‰‹å“ï¼‰">èŠ¸è¡“ï¼ˆæ‰‹å“ï¼‰</option><option value="èŠ¸è¡“ï¼ˆæ‰‹è©±ï¼‰">èŠ¸è¡“ï¼ˆæ‰‹è©±ï¼‰</option><option value="èŠ¸è¡“ï¼ˆæ›¸é“ï¼‰">èŠ¸è¡“ï¼ˆæ›¸é“ï¼‰</option><option value="èŠ¸è¡“ï¼ˆç¥ã®èˆŒï¼ˆã‚´ãƒƒãƒ‰ãƒ»ã‚¿ãƒ³ï¼‰ï¼‰">èŠ¸è¡“ï¼ˆç¥ã®èˆŒï¼ˆã‚´ãƒƒãƒ‰ãƒ»ã‚¿ãƒ³ï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆå è¡“ï¼‰">èŠ¸è¡“ï¼ˆå è¡“ï¼‰</option><option value="èŠ¸è¡“ï¼ˆç´ æ½œã‚Šï¼‰">èŠ¸è¡“ï¼ˆç´ æ½œã‚Šï¼‰</option><option value="èŠ¸è¡“ï¼ˆæƒé™¤ï¼ˆãƒ«ãƒ¡ãƒŠãƒ¼ã‚¸ãƒ¥ï¼‰ï¼‰">èŠ¸è¡“ï¼ˆæƒé™¤ï¼ˆãƒ«ãƒ¡ãƒŠãƒ¼ã‚¸ãƒ¥ï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆé‡£ã‚Šï¼‰">èŠ¸è¡“ï¼ˆé‡£ã‚Šï¼‰</option><option value="èŠ¸è¡“ï¼ˆå¤©ä½“è¦³æ¸¬ï¼‰">èŠ¸è¡“ï¼ˆå¤©ä½“è¦³æ¸¬ï¼‰</option><option value="èŠ¸è¡“ï¼ˆç¾è¡“ï¼‰">èŠ¸è¡“ï¼ˆç¾è¡“ï¼‰</option><option value="èŠ¸è¡“ï¼ˆç‰©èªï¼‰">èŠ¸è¡“ï¼ˆç‰©èªï¼‰</option><option value="èŠ¸è¡“ï¼ˆæ°‘æ—èˆè¸Šï¼ˆç†Šé€ã‚Šï¼‰ï¼‰">èŠ¸è¡“ï¼ˆæ°‘æ—èˆè¸Šï¼ˆç†Šé€ã‚Šï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼ˆè¸Šã‚Šé£Ÿã„ï¼‰">èŠ¸è¡“ï¼ˆè¸Šã‚Šé£Ÿã„ï¼‰</option><option value="èŠ¸è¡“ï¼ˆéœŠæ„Ÿï¼ˆã‚·ãƒƒã‚¯ã‚¹ãƒ»ã‚»ãƒ³ã‚¹ï¼‰ï¼‰">èŠ¸è¡“ï¼ˆéœŠæ„Ÿï¼ˆã‚·ãƒƒã‚¯ã‚¹ãƒ»ã‚»ãƒ³ã‚¹ï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆã‚ªã‚«ãƒªãƒŠï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆã‚ªã‚«ãƒªãƒŠï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆã—ã¤ã‘ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆã—ã¤ã‘ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆãƒ€ãƒ³ã‚¹ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆãƒ€ãƒ³ã‚¹ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆãƒˆãƒªãƒŸãƒ³ã‚°ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆãƒˆãƒªãƒŸãƒ³ã‚°ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆçµµç”»ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆçµµç”»ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆæ¥½å™¨æ¼”å¥ï¼ˆã‚®ã‚¿ãƒ¼ï¼‰ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆæ¥½å™¨æ¼”å¥ï¼ˆã‚®ã‚¿ãƒ¼ï¼‰ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆä½œæ›²ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆä½œæ›²ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆå†™çœŸè¡“ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆå†™çœŸè¡“ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆæ°´å¹³æ€è€ƒï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆæ°´å¹³æ€è€ƒï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆé‡£ã‚Šï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆé‡£ã‚Šï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆèƒ½æ¥½ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆèƒ½æ¥½ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆæ–‡å­¦ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆæ–‡å­¦ï¼‰</option><option value="èŠ¸è¡“ï¼è£½ä½œï¼ˆæ–™ç†ï¼‰">èŠ¸è¡“ï¼è£½ä½œï¼ˆæ–™ç†ï¼‰</option><option value="å‰£">å‰£</option><option value="æ‹³éŠƒ">æ‹³éŠƒ</option><option value="éµé–‹ã‘">éµé–‹ã‘</option><option value="è¨€ã„ãã‚‹ã‚">è¨€ã„ãã‚‹ã‚</option><option value="è€ƒå¤å­¦">è€ƒå¤å­¦</option><option value="è‡ªç„¶">è‡ªç„¶</option><option value="å†™çœŸè¡“">å†™çœŸè¡“</option><option value="å°„æ’ƒï¼ˆã‚µãƒ–ãƒã‚·ãƒ³ã‚¬ãƒ³ï¼‰">å°„æ’ƒï¼ˆã‚µãƒ–ãƒã‚·ãƒ³ã‚¬ãƒ³ï¼‰</option><option value="å°„æ’ƒï¼ˆãƒ©ã‚¤ãƒ•ãƒ«ï¼ã‚·ãƒ§ãƒƒãƒˆã‚¬ãƒ³ï¼‰">å°„æ’ƒï¼ˆãƒ©ã‚¤ãƒ•ãƒ«ï¼ã‚·ãƒ§ãƒƒãƒˆã‚¬ãƒ³ï¼‰</option><option value="å°„æ’ƒï¼ˆæ‹³éŠƒï¼‰">å°„æ’ƒï¼ˆæ‹³éŠƒï¼‰</option><option value="æ‰‹ã•ã°ã">æ‰‹ã•ã°ã</option><option value="é‡æ©Ÿæ¢°æ“ä½œ">é‡æ©Ÿæ¢°æ“ä½œ</option><option value="ä¿¡ç”¨">ä¿¡ç”¨</option><option value="å¿ƒç†å­¦">å¿ƒç†å­¦</option><option value="äººé¡å­¦">äººé¡å­¦</option><option value="å›³æ›¸é¤¨">å›³æ›¸é¤¨</option><option value="æ°´æ³³">æ°´æ³³</option><option value="ç”Ÿç‰©å­¦">ç”Ÿç‰©å­¦</option><option value="ç²¾ç¥åˆ†æ">ç²¾ç¥åˆ†æ</option><option value="è£½ä½œï¼ˆã‚«ã‚¯ãƒ†ãƒ«ï¼‰">è£½ä½œï¼ˆã‚«ã‚¯ãƒ†ãƒ«ï¼‰</option><option value="è£½ä½œï¼ˆãƒ‡ã‚³ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰">è£½ä½œï¼ˆãƒ‡ã‚³ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</option><option value="è£½ä½œï¼ˆãƒ•ã‚§ã‚¤ã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼‰">è£½ä½œï¼ˆãƒ•ã‚§ã‚¤ã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼‰</option><option value="è£½ä½œï¼ˆè¡£è£…ï¼‰">è£½ä½œï¼ˆè¡£è£…ï¼‰</option><option value="è£½ä½œï¼ˆç«ç‚ç“¶ï¼‰">è£½ä½œï¼ˆç«ç‚ç“¶ï¼‰</option><option value="è£½ä½œï¼ˆçµµç”»ï¼‰">è£½ä½œï¼ˆçµµç”»ï¼‰</option><option value="è£½ä½œï¼ˆè£ã¡ç¸«ã„ï¼‰">è£½ä½œï¼ˆè£ã¡ç¸«ã„ï¼‰</option><option value="è£½ä½œï¼ˆåˆºé’ï¼‰">è£½ä½œï¼ˆåˆºé’ï¼‰</option><option value="è£½ä½œï¼ˆå°é“å…·ï¼‰">è£½ä½œï¼ˆå°é“å…·ï¼‰</option><option value="è£½ä½œï¼ˆæŠ˜ã‚Šç´™ï¼‰">è£½ä½œï¼ˆæŠ˜ã‚Šç´™ï¼‰</option><option value="è£½ä½œï¼ˆæ–™ç†ï¼‰">è£½ä½œï¼ˆæ–™ç†ï¼‰</option><option value="è¥¿æ´‹ç¾è¡“å²">è¥¿æ´‹ç¾è¡“å²</option><option value="èª¬å¾—">èª¬å¾—</option><option value="ç´ æ‰‹">ç´ æ‰‹</option><option value="çµ„ã¿ã¤ã">çµ„ã¿ã¤ã</option><option value="æ“ç¸¦ï¼ˆèˆ¹èˆ¶ï¼‰">æ“ç¸¦ï¼ˆèˆ¹èˆ¶ï¼‰</option><option value="å€¤åˆ‡ã‚Š">å€¤åˆ‡ã‚Š</option><option value="åœ°è³ªå­¦">åœ°è³ªå­¦</option><option value="è·³èº">è·³èº</option><option value="è¿½è·¡">è¿½è·¡</option><option value="å¤©æ–‡å­¦">å¤©æ–‡å­¦</option><option value="é›»æ°—ä¿®ç†">é›»æ°—ä¿®ç†</option><option value="é›»å­å·¥å­¦">é›»å­å·¥å­¦</option><option value="ç™»æ”€">ç™»æ”€</option><option value="æŠ•æ“²">æŠ•æ“²</option><option value="é ­çªã">é ­çªã</option><option value="æ—¥æœ¬åˆ€">æ—¥æœ¬åˆ€</option><option value="å¿ã³æ­©ã">å¿ã³æ­©ã</option><option value="åšç‰©å­¦">åšç‰©å­¦</option><option value="ç‰©ç†å­¦">ç‰©ç†å­¦</option><option value="èãè€³">èãè€³</option><option value="å¤‰è£…">å¤‰è£…</option><option value="æ¯å›½èªï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰">æ¯å›½èªï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰</option><option value="æ¯å›½èªï¼ˆè‹±èªï¼‰">æ¯å›½èªï¼ˆè‹±èªï¼‰</option><option value="æ³•å¾‹">æ³•å¾‹</option><option value="æœ¬è‰å­¦">æœ¬è‰å­¦</option><option value="é­…æƒ‘">é­…æƒ‘</option><option value="å¤¢ã®çŸ¥è­˜">å¤¢ã®çŸ¥è­˜</option><option value="å¤¢è¦‹">å¤¢è¦‹</option><option value="ç›®æ˜Ÿ">ç›®æ˜Ÿ</option><option value="è–¬å­¦">è–¬å­¦</option><option value="æ­´å²">æ­´å²</option></select>
                <select id="sortSelect" onchange="resetSkillSort(); renderAll();" class="bg-transparent text-xs font-black outline-none cursor-pointer dark:text-slate-300 force-dark-text">
                    <option value="name" selected="">åå‰é †</option>
                    <option value="newest">è¿½åŠ é † (æ–°)</option>
                    <option value="oldest">è¿½åŠ é † (å¤)</option>
                    <option value="san">æ­£æ°—åº¦é †</option>
                </select>
                <div id="skillSortBadge" class="hidden px-3 py-1 bg-indigo-600 text-white rounded-full text-[10px] font-black flex items-center gap-2">
                    <span id="skillSortName"></span>
                    <button onclick="resetFilters();"><i class="fas fa-times"></i></button>
                </div>
            </div>
            
            <div class="flex gap-2 items-center ml-auto">
                <button onclick="toggleDarkMode()" class="w-10 h-10 flex items-center justify-center rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm">
                    <i id="themeIcon" class="fas fa-sun text-yellow-400"></i>
                </button>
                <button id="backToListBtn" onclick="resetFocus()" class="px-6 py-2 bg-indigo-600 text-white rounded-xl font-black text-sm shadow-lg hover:bg-indigo-700 transition">
                    <i class="fas fa-arrow-left mr-2"></i> æˆ»ã‚‹
                </button>
                
                <button id="btn-delete-all" onclick="showConfirm('all')" class="admin-only px-3 py-2 bg-rose-500 text-white rounded-xl font-black text-xs shadow-sm hover:bg-rose-600 transition" title="å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤">
                    <i class="fas fa-trash-alt mr-1"></i>
                </button>

                <div class="flex gap-1 admin-only">
                    <button id="btn-export-html" onclick="exportReadOnlyHTML()" class="px-3 py-2 bg-indigo-500 text-white rounded-l-xl font-black text-xs shadow-sm hover:bg-indigo-600 transition" title="é–²è¦§å°‚ç”¨HTMLã‚’ä½œæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ (ç”»åƒåŸ‹ã‚è¾¼ã¿ãƒ»å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«)">
                         é–²è¦§ç”¨ (ä¸€ä½“å‹)
                    </button>
                    <button id="btn-export-web" onclick="exportWebFiles()" class="px-3 py-2 bg-emerald-500 text-white rounded-r-xl font-black text-xs shadow-sm hover:bg-emerald-600 transition" title="Webå…¬é–‹ç”¨ã«HTMLã¨ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¦ä¿å­˜ã—ã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã«ä¸Šã’ã‚‹ãªã‚‰ã“ã¡ã‚‰ãŒæ¨å¥¨ã§ã™">
                         Webç”¨ (åˆ†é›¢)
                    </button>
                </div>

                <button id="btn-compress-img" onclick="compressAllImages()" class="admin-only px-3 py-2 bg-orange-400 text-white rounded-xl font-black text-xs shadow-sm hover:bg-orange-500 transition" title="ç™»éŒ²æ¸ˆã¿ç”»åƒã‚’ãƒªã‚µã‚¤ã‚ºã—ã¦å®¹é‡ã‚’ç©ºã‘ã‚‹">
                    <i class="fas fa-compress-arrows-alt mr-1"></i> ç”»åƒè»½é‡åŒ–
                </button>

                <button id="btn-save-json" onclick="saveToFile()" class="px-4 py-2 bg-slate-700 text-white rounded-xl font-black text-xs shadow-sm hover:bg-slate-600 transition" title="JSONå½¢å¼ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—">
                    <i class="fas fa-save mr-1"></i> ä¿å­˜
                </button>
                
                <button onclick="toggleLock()" id="lockBtn" class="px-4 py-2 bg-white dark:bg-slate-800 border border-indigo-100 dark:border-slate-700 text-indigo-600 dark:text-indigo-400 rounded-xl font-black text-xs shadow-sm">
                    <i class="fas fa-unlock mr-1"></i> <span>ç·¨é›†å¯èƒ½</span>
                </button>
            </div>
        </div>

        <header class="mb-8" id="headerContent">
            <h1 class="text-3xl md:text-4xl font-black tracking-tighter mb-6 text-theme-main force-dark-text-white">ã‚ãã¥å“ æ¢ç´¢è€…ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h1>
            <div class="flex flex-wrap gap-4 items-center">
                <div class="relative flex-1 min-w-[280px]">
                    <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-300"></i>
                    <input type="text" id="searchInput" placeholder="åå‰ã€è·æ¥­ã€ã‚·ãƒŠãƒªã‚ªã€æŠ€èƒ½ã§æ¤œç´¢..." oninput="renderAll()" class="w-full pl-10 pr-4 py-3 rounded-2xl text-sm font-bold shadow-sm focus:border-indigo-400 outline-none transition form-input">
                </div>
            </div>
        </header>

        <div id="dropZone" class="admin-only relative w-full py-12 rounded-[2rem] bg-white dark:bg-slate-800 text-center mb-8 border-4 border-dashed border-slate-200 dark:border-slate-700 hover:border-indigo-400 transition-all cursor-pointer">
            <input type="file" id="fileInput" multiple="" accept=".txt,.json" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10">
            <div class="pointer-events-none">
                <i class="fas fa-cloud-upload-alt text-3xl text-indigo-400 mb-2"></i>
                <p class="text-slate-600 dark:text-slate-300 font-black text-sm force-dark-text drop-text">ãƒ•ã‚¡ã‚¤ãƒ«(.txt / .json)ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦è¿½åŠ </p>
                <p class="text-[10px] text-slate-400 mt-1">â€»ç”»åƒãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã‚‹å ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã®å®¹é‡åˆ¶é™ã«ã‚ˆã‚Šä¿å­˜ã§ããªã„ã“ã¨ãŒã‚ã‚Šã¾ã™</p>
            </div>
        </div>

        <div id="paginationTop" class="pagination-container collapsible-content hidden"></div>
        <div id="characterList" class="mb-8 collapsible-content min-h-[10px]" style="max-height: 20000px;"><div class="card is-focused lost-mode" style="border-color: rgb(148, 163, 184);">
                    <div class="lost-watermark">LOST</div>
                    
                        <div class="card-controls admin-only persistent flex items-center gap-2" onclick="event.stopPropagation();">
                            <input type="color" value="#6f6764" onchange="event.stopPropagation(); updateColor('4bdd73aa-6a03-4090-8704-7369344e4fa9', this.value)" class="color-picker-btn" title="è‰²å¤‰æ›´">
                            <button onclick="event.stopPropagation(); toggleLost('4bdd73aa-6a03-4090-8704-7369344e4fa9')" class="icon-btn hover:text-rose-500" title="ãƒ­ã‚¹ãƒˆåˆ‡ã‚Šæ›¿ãˆ"><i class="fas fa-skull-crossbones pointer-events-none"></i></button>
                            <button onclick="event.stopPropagation(); showRawModal('4bdd73aa-6a03-4090-8704-7369344e4fa9')" class="icon-btn hover:text-indigo-500" title="å…ƒãƒ‡ãƒ¼ã‚¿"><i class="fas fa-file-alt pointer-events-none"></i></button>
                            <button onclick="event.stopPropagation(); showConfirm('4bdd73aa-6a03-4090-8704-7369344e4fa9')" class="icon-btn hover:text-rose-600" title="å‰Šé™¤"><i class="fas fa-trash-alt pointer-events-none"></i></button>
                        </div>
                    

                    <div class="header-section" style="background-color: #6f6764; color: #ffffff;" onclick="if(!focusedCharId) jumpToChar('4bdd73aa-6a03-4090-8704-7369344e4fa9')">
                        <img src="data:image/jpeg;base64,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" class="image-preview" onclick="event.stopPropagation(); triggerImageUpload('4bdd73aa-6a03-4090-8704-7369344e4fa9')">
                        <div class="info-container">
                            <div class="char-yomi text-[10px] font-black tracking-widest mb-1 uppercase w-full text-center truncate" style="color: rgba(255,255,255,0.7);">
                                <span class="editable-field" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="yomi" data-bound="true">ã‹ãã‚‰ã€€ã‚†ããŠ</span>
                            </div>
                            <div class="char-name font-black leading-tight mb-2 w-full text-center truncate" title="ç¥æ¥½ å¹¸èˆˆ" style="color: #ffffff;">
                                <span class="editable-field" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="surname" data-bound="true">ç¥æ¥½</span> 
                                <span class="editable-field" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="givenName" data-bound="true">å¹¸èˆˆ</span>
                            </div>
                            <div class="flex flex-wrap gap-2 justify-center view-mode-list:justify-start focused-mode:justify-start tags-wrapper w-full overflow-hidden">
                                <div class="flex items-center gap-2 whitespace-nowrap overflow-hidden max-w-full justify-center">
                                    <span class="px-3 py-1 edition-tag-6 rounded-lg font-black text-sm whitespace-nowrap flex-shrink-0" style="border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">6ç‰ˆ</span>
                                    <span class="px-4 py-1 bg-slate-100 dark:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-lg text-theme-sub whitespace-nowrap overflow-hidden text-ellipsis" style="border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <span class="editable-field" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="age" data-bound="true">42</span>æ­³ / 
                                        <span class="editable-field" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="gender" data-bound="true">ç”·æ€§</span>
                                    </span>
                                </div>
                                <span class="px-4 py-1 rounded-lg font-black text-lg job-tag w-full text-center truncate text-white" style="background:#94a3b8; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" title="ãƒ“ã‚¸ãƒã‚¹ãƒãƒ³">
                                    <span class="editable-field" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="job" data-bound="true">ãƒ“ã‚¸ãƒã‚¹ãƒãƒ³</span>
                                </span>
                            </div>
                            <div class="mt-1 w-full text-xs font-bold flex items-center justify-center gap-1 whitespace-nowrap overflow-hidden" style="color: rgba(255,255,255,0.7);">
                                <span class="truncate" title="èª•ç”Ÿæ—¥: 11æœˆ22æ—¥"><i class="fas fa-birthday-cake mr-0.5"></i>11æœˆ22æ—¥</span>
                                <span class="mx-0.5">|</span>
                                <span class="truncate" title="èº«é•·/ä½“é‡: 172cm / 66kg"><i class="fas fa-ruler-vertical mr-0.5"></i>172cm / <i class="fas fa-weight mr-0.5"></i>66kg</span>
                            </div>

                            
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <div class="mb-6">
                            <span class="text-[9px] text-theme-muted font-black block mb-2 uppercase tracking-widest">ä»£è¡¨ã‚·ãƒŠãƒªã‚ª</span>
                            <div class="p-4 rounded-xl italic text-sm font-bold text-theme-sub info-panel">
                                <span class="editable-field block w-full" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="scenario" data-bound="true">ã¨ã‚ã‚‹å¹¸ã›ãªå®¶æ—ã®è©±</span>
                            </div>
                        </div>
                         <div class="mb-8">
                            <span class="text-[9px] text-theme-muted font-black block mb-2 uppercase tracking-widest">MEMO <i class="fas fa-sticky-note ml-1"></i></span>
                            <div class="p-4 rounded-xl italic text-sm font-bold text-theme-sub info-panel">
                                <span class="editable-field block w-full" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="memo" data-bound="true">ãƒ¡ãƒ¢ãªã—</span>
                            </div>
                        </div>
                        
                        <div class="stat-main-grid">
                            
                                    <div class="stat-box border-str">
                                        <span class="stat-label">STR</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="STR" data-bound="true">10</span>
                                        <span class="stat-sub-val">(50)</span>
                                    </div>
                                
                                    <div class="stat-box border-con">
                                        <span class="stat-label">CON</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="CON" data-bound="true">13</span>
                                        <span class="stat-sub-val">(65)</span>
                                    </div>
                                
                                    <div class="stat-box border-pow">
                                        <span class="stat-label">POW</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="POW" data-bound="true">12</span>
                                        <span class="stat-sub-val">(60)</span>
                                    </div>
                                
                                    <div class="stat-box border-dex">
                                        <span class="stat-label">DEX</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="DEX" data-bound="true">10</span>
                                        <span class="stat-sub-val">(50)</span>
                                    </div>
                                
                                    <div class="stat-box border-app">
                                        <span class="stat-label">APP</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="APP" data-bound="true">12</span>
                                        <span class="stat-sub-val">(60)</span>
                                    </div>
                                
                                    <div class="stat-box border-siz">
                                        <span class="stat-label">SIZ</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="SIZ" data-bound="true">15</span>
                                        <span class="stat-sub-val">(75)</span>
                                    </div>
                                
                                    <div class="stat-box border-int">
                                        <span class="stat-label">INT</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="INT" data-bound="true">14</span>
                                        <span class="stat-sub-val">(70)</span>
                                    </div>
                                
                                    <div class="stat-box border-edu">
                                        <span class="stat-label">EDU</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="EDU" data-bound="true">14</span>
                                        <span class="stat-sub-val">(70)</span>
                                    </div>
                                
                        </div>
                        <div class="stat-sub-grid mb-8">
                            
                                    <div class="stat-box border-hp">
                                        <span class="stat-label">HP</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="HP" data-bound="true">14</span>
                                    </div>
                                
                                    <div class="stat-box border-mp">
                                        <span class="stat-label">MP</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="MP" data-bound="true">12</span>
                                    </div>
                                
                                    <div class="stat-box border-san">
                                        <span class="stat-label">SAN</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="4bdd73aa-6a03-4090-8704-7369344e4fa9" data-field="stats" data-key="SAN" data-bound="true">60</span>
                                    </div>
                                
                        </div>

                        <div class="skill-section">
                            <div class="flex justify-between items-end mb-3 border-b border-slate-100 dark:border-slate-800 pb-1">
                                <span class="text-[9px] text-theme-muted font-black uppercase tracking-widest">æŠ€èƒ½ä¸€è¦§ (ã‚¯ãƒªãƒƒã‚¯ã§ã‚½ãƒ¼ãƒˆ)</span>
                            </div>
                            <div class="skill-list">
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('è¨€ã„ãã‚‹ã‚')" title="è¨€ã„ãã‚‹ã‚">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('è¨€ã„ãã‚‹ã‚')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                è¨€ã„ãã‚‹ã‚
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">25%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'è¨€ã„ãã‚‹ã‚')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'è¨€ã„ãã‚‹ã‚', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'è¨€ã„ãã‚‹ã‚', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰')" title="é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">40%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'é‹è»¢ï¼ˆè‡ªå‹•è»Šï¼‰', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('å¿œæ€¥æ‰‹å½“')" title="å¿œæ€¥æ‰‹å½“">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('å¿œæ€¥æ‰‹å½“')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                å¿œæ€¥æ‰‹å½“
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">65%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å¿œæ€¥æ‰‹å½“')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å¿œæ€¥æ‰‹å½“', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å¿œæ€¥æ‰‹å½“', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('èãè€³')" title="èãè€³">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('èãè€³')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                èãè€³
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">40%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'èãè€³')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'èãè€³', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'èãè€³', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('çµŒç†')" title="çµŒç†">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('çµŒç†')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                çµŒç†
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">30%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'çµŒç†')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'çµŒç†', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'çµŒç†', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼')" title="ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">60%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('ä¿¡ç”¨')" title="ä¿¡ç”¨">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('ä¿¡ç”¨')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                ä¿¡ç”¨
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">50%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ä¿¡ç”¨')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ä¿¡ç”¨', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ä¿¡ç”¨', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('èª¬å¾—')" title="èª¬å¾—">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('èª¬å¾—')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                èª¬å¾—
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">80%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'èª¬å¾—')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'èª¬å¾—', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'èª¬å¾—', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('å›³æ›¸é¤¨')" title="å›³æ›¸é¤¨">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('å›³æ›¸é¤¨')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                å›³æ›¸é¤¨
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">60%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å›³æ›¸é¤¨')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å›³æ›¸é¤¨', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å›³æ›¸é¤¨', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('å€¤åˆ‡ã‚Š')" title="å€¤åˆ‡ã‚Š">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('å€¤åˆ‡ã‚Š')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                å€¤åˆ‡ã‚Š
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">20%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å€¤åˆ‡ã‚Š')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å€¤åˆ‡ã‚Š', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'å€¤åˆ‡ã‚Š', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('æ³•å¾‹')" title="æ³•å¾‹">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('æ³•å¾‹')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                æ³•å¾‹
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">20%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'æ³•å¾‹')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'æ³•å¾‹', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'æ³•å¾‹', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰')" title="ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">52%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ã»ã‹ã®è¨€èªï¼ˆè‹±èªï¼‰', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                    <div class="skill-item  " onclick="event.stopPropagation(); filterBySkill('ç›®æ˜Ÿ')" title="ç›®æ˜Ÿ">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('ç›®æ˜Ÿ')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                
                                                ç›®æ˜Ÿ
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="text-indigo-500 font-black mr-2">60%</span>
                                            
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ç›®æ˜Ÿ')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas fa-eye"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ç›®æ˜Ÿ', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('4bdd73aa-6a03-4090-8704-7369344e4fa9', 'ç›®æ˜Ÿ', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                            </div>
                        </div>
                    </div>
                </div></div>
        <div id="paginationBottom" class="pagination-container collapsible-content hidden"></div>

        <div id="statsSection" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-20 collapsible-content">
            <div class="stats-card shadow-sm">
                <h3 class="stats-header force-dark-text-white"><i class="fas fa-chart-pie mr-2 text-indigo-500"></i>ã‚ãã¥å“ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿</h3>
                <div class="grid grid-cols-2 gap-6 mb-8">
                    <div class="p-4 bg-indigo-600 text-white rounded-3xl shadow-lg relative overflow-hidden">
                        <i class="fas fa-users absolute -right-4 -bottom-4 text-6xl opacity-20"></i>
                        <span class="text-[9px] font-black block mb-1 uppercase tracking-widest opacity-80">ç·ç™»éŒ²æ•°</span>
                        <div class="flex items-baseline gap-1">
                            <span id="stat-total" class="text-4xl font-black">79</span>
                            <span class="text-xs font-black">å</span>
                        </div>
                        <div class="text-right -mt-1">
                            <span class="text-[9px] font-bold opacity-80 text-indigo-200">(ã†ã¡ãƒ­ã‚¹ãƒˆ <span id="stat-lost">6</span>å)</span>
                        </div>
                    </div>
                    <div class="p-4 rounded-3xl border border-slate-100 dark:border-slate-800 info-panel">
                        <span class="stats-sub-header">ç”·å¥³æ¯”</span>
                        <div id="stat-gender" class="flex flex-col gap-2">
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">ç”·æ€§</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-sky-100 text-sky-600">53</span>
                </div>
            
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">å¥³æ€§</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-pink-100 text-pink-600">26</span>
                </div>
            
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">ä»–</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-slate-100 text-slate-600">0</span>
                </div>
            </div>
                    </div>
                </div>
                <div class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-2xl border border-slate-100 dark:border-slate-800 info-panel">
                            <span class="stats-sub-header">ç‰ˆåˆ¥é›†è¨ˆ</span>
                            <div id="stat-versions" class="space-y-2">
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">6ç‰ˆ</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-blue-100 text-blue-600">53</span>
                </div>
            
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">7ç‰ˆ</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-green-100 text-green-600">26</span>
                </div>
            </div>
                        </div>
                        <div class="p-4 rounded-2xl border border-slate-100 dark:border-slate-800 info-panel">
                            <span class="stats-sub-header">SANå€¤ åˆ†å¸ƒ</span>
                            <div id="stat-san" class="space-y-2">
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">å®‰å®š(70+)</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600">32</span>
                </div>
            
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">æ³¨æ„(40-69)</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-slate-100 text-slate-600">45</span>
                </div>
            
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">å±é™º(0-39)</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full bg-rose-100 text-rose-600">2</span>
                </div>
            </div>
                        </div>
                    </div>
                    <div class="p-4 rounded-2xl border border-slate-100 dark:border-slate-800 info-panel">
                        <span class="stats-sub-header">å¹´ä»£åˆ¥é›†è¨ˆ</span>
                        <div id="stat-ages" class="space-y-2">
                <div class="flex items-center gap-2 text-[9px] font-black dark:text-slate-300">
                    <span class="w-8 shrink-0">10ä»£</span>
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 h-1 rounded-full"><div class="bg-indigo-400 h-full" style="width:21.518987341772153%"></div></div>
                    <span class="w-4 text-right">17</span>
                </div>
            
                <div class="flex items-center gap-2 text-[9px] font-black dark:text-slate-300">
                    <span class="w-8 shrink-0">20ä»£</span>
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 h-1 rounded-full"><div class="bg-indigo-400 h-full" style="width:45.56962025316456%"></div></div>
                    <span class="w-4 text-right">36</span>
                </div>
            
                <div class="flex items-center gap-2 text-[9px] font-black dark:text-slate-300">
                    <span class="w-8 shrink-0">30ä»£</span>
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 h-1 rounded-full"><div class="bg-indigo-400 h-full" style="width:20.253164556962027%"></div></div>
                    <span class="w-4 text-right">16</span>
                </div>
            
                <div class="flex items-center gap-2 text-[9px] font-black dark:text-slate-300">
                    <span class="w-8 shrink-0">40ä»£+</span>
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 h-1 rounded-full"><div class="bg-indigo-400 h-full" style="width:12.658227848101266%"></div></div>
                    <span class="w-4 text-right">10</span>
                </div>
            
                <div class="flex items-center gap-2 text-[9px] font-black dark:text-slate-300">
                    <span class="w-8 shrink-0">ä¸æ˜</span>
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 h-1 rounded-full"><div class="bg-indigo-400 h-full" style="width:0%"></div></div>
                    <span class="w-4 text-right">0</span>
                </div>
            </div>
                    </div>
                    
                    <!-- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚¨ãƒªã‚¢ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã™ã‚‹å½¢å¼ã«å¤‰æ›´ï¼‰ -->
                    <!-- ä¿®æ­£: 6å€‹ã®ãƒ‘ãƒãƒ«ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãé…ç½®ã™ã‚‹ãŸã‚ xl:grid-cols-3 (3åˆ—x2è¡Œ) ã«å¤‰æ›´ -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 pt-4 border-t border-slate-100 dark:border-slate-800">
                        <div onclick="showRankingModal('job')" class="p-3 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md cursor-pointer transition-all group">
                            <span class="stats-sub-header group-hover:text-indigo-500 transition-colors">è·æ¥­åˆ†å¸ƒ <i class="fas fa-external-link-alt ml-1 text-[10px] opacity-50"></i></span>
                            <div id="stat-jobs-summary" class="space-y-1"><div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: é«˜æ ¡ç”Ÿ (10å)</div></div>
                        </div>
                        <div onclick="showRankingModal('stats')" class="p-3 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md cursor-pointer transition-all group">
                            <span class="stats-sub-header group-hover:text-indigo-500 transition-colors">ç·åˆèƒ½åŠ›å€¤å¹³å‡ <i class="fas fa-external-link-alt ml-1 text-[10px] opacity-50"></i></span>
                            <div id="stat-top3-summary" class="space-y-1"><div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: äº¬æ¥µ (15.5)</div></div>
                        </div>
                        <div onclick="showRankingModal('height')" class="p-3 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md cursor-pointer transition-all group">
                            <span class="stats-sub-header group-hover:text-indigo-500 transition-colors">èº«é•·ãƒ‡ãƒ¼ã‚¿ <i class="fas fa-external-link-alt ml-1 text-[10px] opacity-50"></i></span>
                            <div id="stat-height-summary" class="space-y-1">
                <div class="flex justify-around text-[10px] font-bold text-slate-500 dark:text-slate-400 mt-1">
                    <span><i class="fas fa-mars text-sky-500 mr-1"></i>Avg: 171.5cm</span>
                    <span><i class="fas fa-venus text-pink-500 mr-1"></i>Avg: 158.3cm</span>
                </div>
            </div>
                        </div>
                        <div onclick="showRankingModal('muscle')" class="p-3 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md cursor-pointer transition-all group">
                            <span class="stats-sub-header group-hover:text-indigo-500 transition-colors">ç­‹è‚‰ç•ªä»˜ <i class="fas fa-external-link-alt ml-1 text-[10px] opacity-50"></i></span>
                            <div id="stat-muscle-summary" class="space-y-1"><div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: ç§‹èŒœ (33)</div></div>
                        </div>
                        <div onclick="showRankingModal('expert')" class="p-3 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md cursor-pointer transition-all group">
                            <span class="stats-sub-header group-hover:text-indigo-500 transition-colors">æ¢ç´¢ã®åŒ  <i class="fas fa-external-link-alt ml-1 text-[10px] opacity-50"></i></span>
                            <div id="stat-expert-summary" class="space-y-1"><div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: æ·±éœŠ (230)</div></div>
                        </div>
                        <!-- è¿½åŠ : äººæ°—æŠ€èƒ½ãƒ©ãƒ³ã‚­ãƒ³ã‚° -->
                        <div onclick="showRankingModal('popular_skills')" class="p-3 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md cursor-pointer transition-all group">
                            <span class="stats-sub-header group-hover:text-indigo-500 transition-colors">äººæ°—æŠ€èƒ½ <i class="fas fa-external-link-alt ml-1 text-[10px] opacity-50"></i></span>
                            <div id="stat-popular-skills-summary" class="space-y-1"><div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: å¿ƒç†å­¦ (54å)</div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stats-card shadow-sm">
                <h3 class="stats-header force-dark-text-white"><i class="fas fa-calendar-alt mr-2 text-rose-500"></i>èª•ç”Ÿæ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h3>
                <div id="stat-months" class="grid grid-cols-4 gap-3 mb-2">
                <div onclick="filterByMonth(1)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">1æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">6</div>
                </div>
            
                <div onclick="filterByMonth(2)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">2æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">3</div>
                </div>
            
                <div onclick="filterByMonth(3)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">3æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">2</div>
                </div>
            
                <div onclick="filterByMonth(4)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">4æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">7</div>
                </div>
            
                <div onclick="filterByMonth(5)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">5æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">5</div>
                </div>
            
                <div onclick="filterByMonth(6)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">6æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">7</div>
                </div>
            
                <div onclick="filterByMonth(7)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">7æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">5</div>
                </div>
            
                <div onclick="filterByMonth(8)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">8æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">8</div>
                </div>
            
                <div onclick="filterByMonth(9)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">9æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">4</div>
                </div>
            
                <div onclick="filterByMonth(10)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">10æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">9</div>
                </div>
            
                <div onclick="filterByMonth(11)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">11æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">11</div>
                </div>
            
                <div onclick="filterByMonth(12)" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">12æœˆ</div>
                    <div class="text-2xl font-black text-indigo-500">5</div>
                </div>
            </div>
                <div id="stat-unassigned-month" class="flex justify-end mb-6">
                <div onclick="filterByMonth(-1)" class="px-4 py-2 rounded-xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors flex items-center gap-2 shadow-sm">
                    <span class="text-xs text-slate-400 font-black"><i class="fas fa-question-circle mr-1"></i>æœªè¨­å®š</span>
                    <span class="text-sm font-black text-slate-600 dark:text-slate-300">7</span>
                </div>
            </div>
                <div class="p-4 rounded-2xl border border-slate-100 dark:border-slate-800 info-panel">
                    <div class="flex justify-between items-center mb-4">
                        <button onclick="changeMonth(-1)" class="p-1 hover:text-indigo-500"><i class="fas fa-chevron-left text-slate-500 dark:text-slate-300 force-dark-text"></i></button>
                        <span id="calendar-title" class="font-black text-sm text-slate-700 dark:text-slate-200 force-dark-text">2026å¹´ 2æœˆ</span>
                        <button onclick="changeMonth(1)" class="p-1 hover:text-indigo-500"><i class="fas fa-chevron-right text-slate-500 dark:text-slate-300 force-dark-text"></i></button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">1</span><div class="bday-tag" style="border-color: rgb(230, 218, 222); color: rgb(230, 218, 222); background-color: rgba(230, 218, 222, 0.082);">ç¥‡é³´</div></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">2</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">3</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">4</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">5</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">6</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">7</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">8</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">9</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">10</span><div class="bday-tag" style="border-color: rgb(199, 92, 179); color: rgb(199, 92, 179); background-color: rgba(199, 92, 179, 0.082);">ã‚¨ãƒªã‚«ï¼ãƒŠã‚¤ãƒˆãƒ¬ã‚¤</div></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">11</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">12</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">13</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">14</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">15</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">16</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">17</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">18</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">19</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">20</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">21</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">22</span><div class="bday-tag" style="border-color: rgb(245, 207, 159); color: rgb(245, 207, 159); background-color: rgba(245, 207, 159, 0.082);">æ£—</div></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">23</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">24</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">25</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">26</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">27</span></div><div class="calendar-day border-t border-l border-slate-100 dark:border-slate-800"><span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">28</span></div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="confirmModal" class="modal-overlay">
        <div class="bg-white dark:bg-slate-800 p-8 rounded-3xl max-w-sm w-full text-center shadow-2xl modal-box modal-bg">
            <h3 class="text-lg font-black mb-2 text-theme-main modal-text">ç¢ºèª</h3>
            <p id="confirmMessage" class="text-theme-sub text-xs mb-6 modal-text"></p>
            <div id="confirmButtonsStandard" class="flex gap-2 w-full">
                <button onclick="closeConfirm()" class="flex-1 py-3 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 font-black rounded-xl text-xs">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button id="confirmExecBtn" class="flex-1 py-3 bg-rose-500 text-white font-black rounded-xl text-xs">å®Ÿè¡Œ</button>
            </div>
            <div id="confirmButtonsOverwrite" class="flex gap-2 w-full hidden">
                <button id="btn-cancel-up" class="flex-1 py-3 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 font-black rounded-xl text-[10px]">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button id="btn-new-up" class="flex-1 py-3 bg-indigo-500 text-white font-black rounded-xl text-[10px]">æ–°è¦è¿½åŠ </button>
                <button id="btn-overwrite-up" class="flex-1 py-3 bg-rose-500 text-white font-black rounded-xl text-[10px]">ä¸Šæ›¸ã</button>
            </div>
        </div>
    </div>

    <div id="rawTextModal" class="modal-overlay">
        <div class="bg-white dark:bg-slate-800 p-6 rounded-3xl max-w-2xl w-full shadow-2xl flex flex-col max-h-[80vh] modal-box modal-bg">
            <h3 class="text-lg font-black mb-4 text-theme-main modal-text">ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿</h3>
            <pre id="rawTextArea" class="flex-1 bg-slate-50 dark:bg-slate-900 p-4 rounded-xl overflow-y-auto text-[10px] font-mono whitespace-pre-wrap text-theme-sub modal-text modal-pre-bg"></pre>
            <button onclick="closeRawModal()" class="mt-4 w-full py-3 bg-slate-900 text-white font-black rounded-xl text-xs">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <!-- æ±ç”¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="rankingModal" class="modal-overlay" onclick="if(event.target === this) closeRankingModal()">
        <div class="bg-white dark:bg-slate-800 p-6 rounded-3xl max-w-4xl w-full shadow-2xl flex flex-col max-h-[90vh] relative modal-box modal-bg">
            <!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³è¿½åŠ  (å³ä¸Šå›ºå®š) -->
            <button onclick="closeRankingModal()" class="absolute top-4 right-4 w-8 h-8 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-full text-slate-500 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors z-50">
                <i class="fas fa-times"></i>
            </button>
            
            <h3 id="rankingTitle" class="text-lg font-black mb-4 text-theme-main modal-text flex items-center pr-8">
                <i class="fas fa-trophy text-yellow-500 mr-2"></i>ãƒ©ãƒ³ã‚­ãƒ³ã‚°è©³ç´°
            </h3>
            <div id="rankingContent" class="flex-1 overflow-y-auto pb-4">
                <!-- ã“ã“ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãŒç”Ÿæˆã•ã‚Œã‚‹ -->
            </div>
            <button onclick="closeRankingModal()" class="mt-2 w-full py-3 bg-slate-900 text-white font-black rounded-xl text-xs">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <script>
        // DATA_INJECTION_POINT_START
let characters = [];
// DATA_INJECTION_POINT_END
        
        // READONLY_FLAG_START
let isReadOnlyMode = true;
// READONLY_FLAG_END

        // WEB_FETCH_FLAG_START
let isWebFetchMode = true;
// WEB_FETCH_FLAG_END

        let viewMode = 'simple';
        let isLocked = false;
        let isCollapsed = false;
        let focusedCharId = null;
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let activeVersionFilter = null;
        let isDarkMode = false;
        let currentSkillFilter = "";
        let currentMonthFilter = null; // æ–°è¦è¿½åŠ : æœˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨å¤‰æ•°
        let currentPage = 1;
        const itemsPerPage = 20; 
        
        let isSharedMode = false;

        // --- View Only Check ---
        function isViewOnlyMode() {
            return isReadOnlyMode || isWebFetchMode || isLocked;
        }

        // --- Data Persistence ---
        function saveData() {
            if(isReadOnlyMode || isWebFetchMode) return;
            try {
                localStorage.setItem('coc_db_data', JSON.stringify(characters));
            } catch (e) {
                alert("å®¹é‡åˆ¶é™ã«ã‚ˆã‚Šä¿å­˜ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚\nã€Œç”»åƒè»½é‡åŒ–ã€ãƒœã‚¿ãƒ³ã§å®¹é‡ã‚’ç©ºã‘ã‚‹ã‹ã€\nJSONä¿å­˜ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚");
            }
        }
        function loadData() {
            if(isReadOnlyMode || isWebFetchMode) return;
            const data = localStorage.getItem('coc_db_data');
            if(data) {
                try { 
                    characters = JSON.parse(data); 
                    characters.forEach(c => {
                        const str = parseInt(c.stats.STR);
                        if (!isNaN(str)) c.version = (str > 25) ? "7ç‰ˆ" : "6ç‰ˆ";
                        
                        // é‡è¤‡æŠ€èƒ½ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆçŠ¶æ…‹ã‚’ä¿æŒ)
                        if (c.skills) {
                            const uniqueMap = {};
                            const secretMap = {};
                            c.skills.forEach(s => {
                                uniqueMap[s.name] = uniqueMap[s.name] ? Math.max(uniqueMap[s.name], s.val) : s.val;
                                if(s.secret) secretMap[s.name] = true;
                            });
                            c.skills = Object.keys(uniqueMap).map(name => ({ name, val: uniqueMap[name], secret: !!secretMap[name] }));
                        }
                    });
                    saveData(); // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¾Œã®çŠ¶æ…‹ã‚’ä¿å­˜
                    updateStats();
                    renderAll();
                    renderCalendar();
                } catch(e) { console.error(e); }
            }
        }

        // --- File Export (JSON) ---
        function getExportData() {
            // ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ™‚ã«ã¯ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæŠ€èƒ½ã‚’ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å®Œå…¨ã«å‰Šé™¤ã™ã‚‹
            return characters.map(c => {
                const copy = { ...c };
                if (copy.skills) {
                    copy.skills = copy.skills.filter(s => !s.secret);
                }
                return copy;
            });
        }

        function saveToFile() {
            // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ã¯ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè¨­å®šã‚‚å«ã‚ã¦å®Œå…¨ã«ä¿å­˜ã™ã‚‹
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(characters));
            const node = document.createElement('a');
            node.setAttribute("href", dataStr);
            node.setAttribute("download", "coc_db_backup.json");
            document.body.appendChild(node);
            node.click();
            node.remove();
        }

        // --- é–²è¦§å°‚ç”¨HTMLæ›¸ãå‡ºã— (ä¸€ä½“å‹) ---
        function exportReadOnlyHTML() {
            let htmlContent = document.documentElement.outerHTML;
            const exportData = getExportData();
            const dataScript = `let characters = ${JSON.stringify(exportData)};`;
            htmlContent = htmlContent.replace(
                /\/\/ DATA_INJECTION_POINT_START[\s\S]*?\/\/ DATA_INJECTION_POINT_END/,
                `// DATA_INJECTION_POINT_START\n${dataScript}\n// DATA_INJECTION_POINT_END`
            );
            htmlContent = htmlContent.replace(
                /\/\/ READONLY_FLAG_START[\s\S]*?\/\/ READONLY_FLAG_END/,
                `// READONLY_FLAG_START\nlet isReadOnlyMode = true;\n// READONLY_FLAG_END`
            );
            htmlContent = htmlContent.replace('<body class="', '<body class="readonly-view ');
            downloadFile(htmlContent, 'coc_db_readonly.html', 'text/html');
        }

        // --- Webå…¬é–‹ç”¨æ›¸ãå‡ºã— (åˆ†é›¢å‹) ---
        function exportWebFiles() {
            // data.jsonã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›
            const exportData = getExportData();
            const jsonStr = JSON.stringify(exportData);
            downloadFile(jsonStr, 'data.json', 'application/json');
            
            let htmlContent = document.documentElement.outerHTML;
            htmlContent = htmlContent.replace(
                /\/\/ DATA_INJECTION_POINT_START[\s\S]*?\/\/ DATA_INJECTION_POINT_END/,
                `// DATA_INJECTION_POINT_START\nlet characters = [];\n// DATA_INJECTION_POINT_END`
            );
            htmlContent = htmlContent.replace(
                /\/\/ READONLY_FLAG_START[\s\S]*?\/\/ READONLY_FLAG_END/,
                `// READONLY_FLAG_START\nlet isReadOnlyMode = true;\n// READONLY_FLAG_END`
            );
            htmlContent = htmlContent.replace(
                /\/\/ WEB_FETCH_FLAG_START[\s\S]*?\/\/ WEB_FETCH_FLAG_END/,
                `// WEB_FETCH_FLAG_START\nlet isWebFetchMode = true;\n// WEB_FETCH_FLAG_END`
            );
            htmlContent = htmlContent.replace('<body class="', '<body class="readonly-view ');
            downloadFile(htmlContent, 'index.html', 'text/html');
            alert('ã€Œindex.htmlã€ã¨ã€Œdata.jsonã€ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚\nWebã‚µãƒ¼ãƒãƒ¼ã®åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚');
        }

        function downloadFile(content, fileName, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            applyDarkMode();
            localStorage.setItem('coc_db_theme', isDarkMode ? 'dark' : 'light');
        }
        
        function applyDarkMode() {
            if(isDarkMode) {
                document.documentElement.classList.add('dark');
                document.getElementById('mainBody').classList.add('dark');
                document.getElementById('themeIcon').className = 'fas fa-sun text-yellow-400';
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('mainBody').classList.remove('dark');
                document.getElementById('themeIcon').className = 'fas fa-moon text-slate-500';
            }
            renderAll();
            updateStats();
        }

        function toggleCollapseList() {
            isCollapsed = !isCollapsed;
            const list = document.getElementById('characterList');
            const pageTop = document.getElementById('paginationTop');
            const pageBot = document.getElementById('paginationBottom');
            
            if(list) list.classList.toggle('is-collapsed', isCollapsed);
            if(pageTop) pageTop.classList.toggle('is-collapsed', isCollapsed);
            if(pageBot) pageBot.classList.toggle('is-collapsed', isCollapsed);
            
            document.getElementById('collapseBtn').innerHTML = isCollapsed 
                ? '<i class="fas fa-expand-alt mr-1"></i>ä¸€è¦§ã‚’è¡¨ç¤º' 
                : '<i class="fas fa-compress-alt mr-1"></i>ä¸€è¦§ã‚’éš ã™';
        }

        function toggleLock() {
            if(isSharedMode || isReadOnlyMode) return;
            isLocked = !isLocked;
            updateLockUI();
        }

        function updateLockUI() {
            const btn = document.getElementById('lockBtn');
            const body = document.getElementById('mainBody');
            const dropZone = document.getElementById('dropZone');
            
            if(isReadOnlyMode) {
                 btn.style.display = 'none';
                 return;
            }

            if (isLocked) {
                btn.innerHTML = '<i class="fas fa-lock text-rose-500"></i> <span class="text-rose-500">ãƒ­ãƒƒã‚¯ä¸­</span>';
                body.classList.add('readonly-mode');
                dropZone.classList.add('hidden');
            } else {
                btn.innerHTML = '<i class="fas fa-unlock text-indigo-500"></i> <span>ç·¨é›†å¯èƒ½</span>';
                body.classList.remove('readonly-mode');
                if(!focusedCharId) dropZone.classList.remove('hidden');
            }
            renderAll();
            updateStats();
        }

        function setViewMode(mode) {
            viewMode = mode;
            focusedCharId = null;
            document.querySelectorAll('.view-btn').forEach(btn => {
                const active = btn.dataset.mode === mode;
                if(active) btn.classList.add('active'); else btn.classList.remove('active');
            });
            if (mode === 'simple') currentPage = 1;
            renderAll();
        }

        function toggleVersionFilter(ver) {
            activeVersionFilter = (activeVersionFilter === ver) ? null : ver;
            ['6ç‰ˆ', '7ç‰ˆ'].forEach(v => {
                const btn = document.getElementById(`filter-${v.charAt(0)}`);
                const active = activeVersionFilter === v;
                if(active) btn.classList.add('active'); else btn.classList.remove('active');
            });
            currentPage = 1;
            renderAll();
        }

        function resetSkillSort() {
            currentSkillFilter = "";
            const skillSelect = document.getElementById('skillSelect');
            if(skillSelect) skillSelect.value = "";
            const badge = document.getElementById('skillSortBadge');
            if(badge) badge.classList.add('hidden');
        }

        // æ–°è¦: ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è§£é™¤ï¼ˆæœˆã‚‚å«ã‚€ï¼‰
        function resetFilters() {
            currentSkillFilter = "";
            currentMonthFilter = null; // æœˆãƒ•ã‚£ãƒ«ã‚¿ã‚‚è§£é™¤
            
            const skillSelect = document.getElementById('skillSelect');
            if(skillSelect) skillSelect.value = "";
            
            const badge = document.getElementById('skillSortBadge');
            if(badge) badge.classList.add('hidden');
            
            renderAll();
        }

        function filterBySkill(skillName) {
            currentSkillFilter = skillName;
            currentMonthFilter = null; // æŠ€èƒ½ãƒ•ã‚£ãƒ«ã‚¿æ™‚ã¯æœˆãƒ•ã‚£ãƒ«ã‚¿è§£é™¤
            
            const badge = document.getElementById('skillSortBadge');
            const badgeName = document.getElementById('skillSortName');
            if(skillName) {
                badge.classList.remove('hidden');
                badgeName.innerText = `æŠ€èƒ½ã‚½ãƒ¼ãƒˆ: ${skillName}`;
            } else {
                badge.classList.add('hidden');
            }
            currentPage = 1;
            renderAll();
        }

        // æ–°è¦: æœˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        function filterByMonth(month) {
            currentMonthFilter = month;
            currentSkillFilter = ""; // æœˆãƒ•ã‚£ãƒ«ã‚¿æ™‚ã¯æŠ€èƒ½ãƒ•ã‚£ãƒ«ã‚¿è§£é™¤
            
            const badge = document.getElementById('skillSortBadge');
            const badgeName = document.getElementById('skillSortName');
            badge.classList.remove('hidden');
            if (month === -1) {
                badgeName.innerText = `èª•ç”Ÿæœˆ: æœªè¨­å®š`;
            } else {
                badgeName.innerText = `èª•ç”Ÿæœˆ: ${month}æœˆ`;
            }
            
            // æŠ€èƒ½ã‚»ãƒ¬ã‚¯ãƒˆã®ãƒªã‚»ãƒƒãƒˆ
            const skillSelect = document.getElementById('skillSelect');
            if(skillSelect) skillSelect.value = "";

            setViewMode('list');
            document.getElementById('characterList').scrollIntoView({behavior:'smooth'});
        }

        const fileInput = document.getElementById('fileInput');
        fileInput.addEventListener('change', e => { handleFiles(e.target.files); e.target.value = ''; });

        // --- é‡è¤‡ãƒã‚§ãƒƒã‚¯é–¢é€£ã®è¿½åŠ é–¢æ•° ---
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦èª­ã¿è¾¼ã‚€Promise
        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = e => resolve({ text: e.target.result, name: file.name });
                reader.onerror = e => reject(e);
                reader.readAsText(file);
            });
        }

        // é‡è¤‡ç¢ºèªç”¨ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•° (Promiseã§çµæœã‚’å¾…ã¤)
        function confirmOverwrite(name) {
            return new Promise(resolve => {
                const m = document.getElementById('confirmModal');
                const msg = document.getElementById('confirmMessage');
                const btnStandard = document.getElementById('confirmButtonsStandard');
                const btnOverwrite = document.getElementById('confirmButtonsOverwrite');

                msg.innerHTML = `<span class="font-bold text-indigo-500">${name}</span><br>ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã¾ã™ã‹ï¼Ÿ`;
                
                // è¡¨ç¤ºã™ã‚‹ãƒœã‚¿ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆ
                btnStandard.classList.add('hidden');
                btnOverwrite.classList.remove('hidden');

                const close = (result) => {
                    m.style.display = 'none';
                    // å°‘ã—é…å»¶ã•ã›ã¦ã‹ã‚‰ãƒœã‚¿ãƒ³è¡¨ç¤ºã‚’å…ƒã«æˆ»ã™
                    setTimeout(() => { 
                        btnStandard.classList.remove('hidden');
                        btnOverwrite.classList.add('hidden');
                    }, 100);
                    resolve(result); // 'cancel', 'new', 'overwrite'
                };

                document.getElementById('btn-cancel-up').onclick = () => close('cancel');
                document.getElementById('btn-new-up').onclick = () => close('new');
                document.getElementById('btn-overwrite-up').onclick = () => close('overwrite');

                m.style.display = 'flex';
            });
        }

        async function handleFiles(files) {
            if (isLocked || isReadOnlyMode) return;
            
            const fileArray = Array.from(files);
            
            // é †æ¬¡å‡¦ç†ã®ãŸã‚ã«for...ofãƒ«ãƒ¼ãƒ—ã‚’ä½¿ç”¨
            for (const file of fileArray) {
                try {
                    const { text, name: fileName } = await readFileAsText(file);
                    
                    if (fileName.endsWith('.json')) {
                         try {
                             const imported = JSON.parse(text);
                             if(Array.isArray(imported)) {
                                 imported.forEach(c => {
                                     c.id = crypto.randomUUID(); 
                                     characters.push(c);
                                 });
                                 saveData();
                                 updateStats();
                                 renderAll();
                                 alert('ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¾ã—ãŸ');
                                 continue; // JSONã¯ãƒ«ãƒ¼ãƒ—ç¶™ç¶š
                             }
                         } catch(err) { console.error(err); }
                         continue;
                    } 

                    // ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ã‚¹
                    let newChar = null;
                    try {
                        newChar = parseCharacter(text, fileName);
                    } catch(err) {
                        console.error("Parse Error", err);
                        newChar = { 
                            id: crypto.randomUUID(), surname: fileName, givenName: "(èª­è¾¼ã‚¨ãƒ©ãƒ¼)", 
                            stats:{}, skills:[], rawText: text, addedAt: Date.now() 
                        };
                    }

                    if(newChar) {
                        newChar.rawText = text;
                        newChar.addedAt = Date.now();
                        newChar.isLost = false; 
                        newChar.memo = "";

                        // é‡è¤‡ãƒã‚§ãƒƒã‚¯
                        const existingIndex = characters.findIndex(c => 
                            c.surname === newChar.surname && c.givenName === newChar.givenName
                        );

                        if (existingIndex !== -1) {
                            // é‡è¤‡ã‚ã‚Š -> ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
                            const choice = await confirmOverwrite(`${newChar.surname} ${newChar.givenName}`);
                            
                            if (choice === 'cancel') {
                                continue; // ã‚¹ã‚­ãƒƒãƒ—
                            } else if (choice === 'overwrite') {
                                // ä¸Šæ›¸ãå‡¦ç† (æ—¢å­˜ã®IDã€ç”»åƒã€è‰²ã€ãƒ­ã‚¹ãƒˆçŠ¶æ…‹ãªã©ã¯ç¶­æŒ)
                                const oldChar = characters[existingIndex];
                                newChar.id = oldChar.id; 
                                newChar.image = oldChar.image;
                                newChar.color = oldChar.color || newChar.color;
                                newChar.isLost = oldChar.isLost;
                                newChar.memo = oldChar.memo;
                                newChar.scenario = oldChar.scenario || newChar.scenario; // ã‚·ãƒŠãƒªã‚ªã‚‚ç¶­æŒã—ãŸã»ã†ãŒã„ã„ã‹ã‚‚ï¼Ÿã„ã‚„ãƒ†ã‚­ã‚¹ãƒˆå„ªå…ˆã‹ã€‚ä¸€æ—¦ãƒ†ã‚­ã‚¹ãƒˆå„ªå…ˆã§ãªã‘ã‚Œã°ç¶­æŒã€‚
                                if(newChar.scenario === "æœªè¨˜å…¥" || !newChar.scenario) newChar.scenario = oldChar.scenario;

                                // é…åˆ—ã‚’æ›´æ–°
                                characters[existingIndex] = newChar;
                            } else {
                                // æ–°è¦è¿½åŠ  (IDã¯æ—¢ã«parseCharacterã§æ–°è¦ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹)
                                characters.push(newChar);
                            }
                        } else {
                            // é‡è¤‡ãªã— -> æ–°è¦è¿½åŠ 
                            characters.push(newChar);
                        }
                    }
                } catch(e) {
                    console.error("File Read Error:", e);
                }
            }
            
            // å…¨ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†å¾Œã«ä¿å­˜ãƒ»æ›´æ–°
            saveData();
            updateStats();
            renderAll();
            document.getElementById('fileInput').value = ''; // inputãƒªã‚»ãƒƒãƒˆ
        }

        function parseCharacter(text, fileName) {
            const lines = text.split(/\r?\n/);
            const firstLine = lines[0] || "";
            
            const nameMatch = firstLine.match(/^([^\sï¼ˆ(]+)[ã€€\s]+([^\sï¼ˆ(]+)(?:[\(ï¼ˆ](.+?)[\)ï¼‰])?\s*(?:[\(ï¼ˆ](.+?)[\)ï¼‰])?\s+([^\s]+)\s+([^\s]+)/);
            
            let surname = fileName.replace('.txt', '');
            let givenName = "";
            let yomi = "";
            let ageStr = "??";
            let job = "ä¸æ˜";
            let gender = "ä¸æ˜";

            if (nameMatch) {
                [_, surname, givenName, yomi, ageStr, job, gender] = nameMatch;
            } else {
                 const parts = firstLine.trim().split(/[\sã€€]+/);
                 if(parts.length >= 1) surname = parts[0];
                 if(parts.length >= 2) givenName = parts[1];
            }

            const extract = (regex, def = "0") => {
                const m = text.match(regex);
                return m ? m[1].trim() : def;
            };

            const skillsMap = {};
            const ignoreList = ['STR','CON','POW','DEX','APP','SIZ','INT','EDU','HP','MP','SAN','è€ä¹…åŠ›','ãƒã‚¸ãƒƒã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆ','æ­£æ°—åº¦','å¹¸é‹','ãƒ€ãƒ¡ãƒ¼ã‚¸ãƒ»ãƒœãƒ¼ãƒŠã‚¹','ãƒ“ãƒ«ãƒ‰','ç§»å‹•ç‡'];
            const skillRegex = /([^\sï¼š:]+)[:ï¼š]\s*(\d+)%/g;
            let m;
            while ((m = skillRegex.exec(text)) !== null) {
                const sName = m[1].trim();
                const sVal = parseInt(m[2]);
                if(!ignoreList.includes(sName)) {
                     skillsMap[sName] = skillsMap[sName] ? Math.max(skillsMap[sName], sVal) : sVal;
                }
            }
            const skills = Object.keys(skillsMap).map(name => ({ name, val: skillsMap[name], secret: false }));

            const strVal = parseInt(extract(/STR[:ï¼š]\s*(\d+)/i));
            const is7th = strVal > 25;

            let birthday = "æœªè¨­å®š";
            const bdayMatch = text.match(/ã€èª•ç”Ÿæ—¥ã€‘([^\s\n]+)/);
            if(bdayMatch) {
                birthday = bdayMatch[1];
            } else {
                const dateMatch = text.match(/(\d{1,2})æœˆ(\d{1,2})æ—¥/);
                if(dateMatch) birthday = `${dateMatch[1]}æœˆ${dateMatch[2]}æ—¥`;
            }

            let height = "??";
            let weight = "??";
            const hwLineMatch = text.match(/èº«é•·[\/ï¼]ä½“é‡[:ï¼š\sã€€]*([^\n]+)/);
            if (hwLineMatch) {
                const valPart = hwLineMatch[1];
                const vals = valPart.match(/(\d+(?:\.\d+)?)(?:cm)?[\/ï¼](\d+(?:\.\d+)?)(?:kg)?/);
                if (vals) {
                    height = vals[1];
                    weight = vals[2];
                }
            }
            if (height === "??") {
                const hMatch = text.match(/èº«é•·[:ï¼š\sã€€]*(\d+(?:\.\d+)?)(?:cm)?/);
                if (hMatch) height = hMatch[1];
            }
            if (weight === "??") {
                const wMatch = text.match(/ä½“é‡[:ï¼š\sã€€]*(\d+(?:\.\d+)?)(?:kg)?/);
                if (wMatch) weight = wMatch[1];
            }

            return {
                id: crypto.randomUUID(),
                surname, givenName, yomi: yomi || "", age: ageStr || "??", job: job || "ä¸æ˜", gender: gender || "ä¸æ˜",
                height, weight, 
                stats: {
                    STR: extract(/STR[:ï¼š]\s*(\d+)/i), CON: extract(/CON[:ï¼š]\s*(\d+)/i),
                    POW: extract(/POW[:ï¼š]\s*(\d+)/i), DEX: extract(/DEX[:ï¼š]\s*(\d+)/i),
                    APP: extract(/APP[:ï¼š]\s*(\d+)/i), SIZ: extract(/SIZ[:ï¼š]\s*(\d+)/i),
                    INT: extract(/INT[:ï¼š]\s*(\d+)/i), EDU: extract(/EDU[:ï¼š]\s*(\d+)/i),
                    HP: extract(/(?:è€ä¹…åŠ›|HP)[:ï¼š]\s*(\d+)/) || "0", MP: extract(/(?:ãƒã‚¸ãƒƒã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆ|MP)[:ï¼š]\s*(\d+)/) || "0",
                    SAN: extract(/(?:æ­£æ°—åº¦|SAN)[:ï¼š]\s*(\d+)/) || "0"
                },
                san: parseInt(extract(/(?:æ­£æ°—åº¦|SAN)[:ï¼š]\s*(\d+)/, "50")),
                birthday: birthday,
                color: extract(/ã‚«ãƒ©ãƒ¼[:ï¼š]\s*(#[0-9a-fA-F]{6})/, "#6366f1"),
                version: is7th ? "7ç‰ˆ" : "6ç‰ˆ",
                skills: skills,
                image: null, scenario: "",
                rawText: text,
                addedAt: Date.now(),
                isLost: false,
                memo: ""
            };
        }

        function updateSkillSelect() {
            const allSkills = new Set();
            const viewOnly = isViewOnlyMode();
            
            characters.forEach(c => { 
                if(c.skills) c.skills.forEach(s => {
                    if (viewOnly && s.secret) return;
                    allSkills.add(s.name);
                }); 
            });
            const sortedSkills = Array.from(allSkills).sort((a,b) => a.localeCompare(b, 'ja'));
            const select = document.getElementById('skillSelect');
            if(select) {
                const currentVal = currentSkillFilter;
                select.innerHTML = '<option value="">æŠ€èƒ½ã§æŠ½å‡ºãƒ»ã‚½ãƒ¼ãƒˆ...</option>';
                sortedSkills.forEach(s => {
                    const opt = document.createElement('option'); opt.value = s; opt.innerText = s;
                    if(s === currentVal) opt.selected = true;
                    select.appendChild(opt);
                });
            }
        }

        // æ–°è¦è¿½åŠ : è‰²ã®æ˜ã‚‹ã•ã‚’åˆ¤å®šã—ã¦ç™½ã‹é»’ã‹ã‚’è¿”ã™é–¢æ•°
        function getTextColor(hex) {
            if (!hex) return '#1e293b';
            // #ãŒã‚ã‚‹å ´åˆã¯é™¤å»
            const color = hex.charAt(0) === '#' ? hex.substring(1, 7) : hex;
            const r = parseInt(color.substring(0, 2), 16);
            const g = parseInt(color.substring(2, 4), 16);
            const b = parseInt(color.substring(4, 6), 16);
            // YIQå¼ã«ã‚ˆã‚‹è¼åº¦è¨ˆç®—
            const yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
            return (yiq >= 128) ? '#1e293b' : '#ffffff';
        }

        function renderAll() {
            const list = document.getElementById('characterList');
            const body = document.getElementById('mainBody');
            const backBtn = document.getElementById('backToListBtn');
            const toolbar = document.getElementById('normalToolbar');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            const sortMode = document.getElementById('sortSelect').value;
            const viewOnly = isViewOnlyMode();

            body.className = body.className.replace(/view-mode-\w+/g, '').replace('focused-mode', '');
            if (focusedCharId) {
                body.classList.add('focused-mode');
                backBtn.classList.remove('hidden');
                toolbar.classList.add('hidden');
            } else {
                body.classList.add(`view-mode-${viewMode}`);
                backBtn.classList.add('hidden');
                toolbar.classList.remove('hidden');
                
                document.getElementById('btn-mode-icons').classList.toggle('active', viewMode === 'icons');
                document.getElementById('btn-mode-icons').classList.toggle('border-indigo-500', viewMode === 'icons');
                document.getElementById('btn-mode-icons').classList.toggle('text-indigo-600', viewMode === 'icons');
                
                document.getElementById('btn-mode-list').classList.toggle('active', viewMode === 'list');
                document.getElementById('btn-mode-list').classList.toggle('border-indigo-500', viewMode === 'list');
                document.getElementById('btn-mode-list').classList.toggle('text-indigo-600', viewMode === 'list');
            }
            
            ['6ç‰ˆ', '7ç‰ˆ'].forEach(v => {
                const btn = document.getElementById(`filter-${v.charAt(0)}`);
                const active = activeVersionFilter === v;
                btn.classList.toggle('border-indigo-500', active);
                btn.classList.toggle('text-indigo-600', active);
                btn.classList.toggle('text-slate-400', !active);
            });

            if(isDarkMode) body.classList.add('dark');
            if(isReadOnlyMode || isWebFetchMode) body.classList.add('readonly-view');

            let displayChars = characters.filter(c => {
                const visibleSkills = c.skills.filter(s => !(viewOnly && s.secret));
                const skillsStr = visibleSkills.map(s => s.name).join(' ');
                const fullStr = `${c.surname}${c.givenName}${c.yomi}${c.job}${c.scenario}${skillsStr}`.toLowerCase();
                const matchesSearch = fullStr.includes(searchVal);
                const matchesFilter = !activeVersionFilter || c.version === activeVersionFilter;
                const matchesSkill = !currentSkillFilter || visibleSkills.some(s => s.name === currentSkillFilter);
                
                let matchesMonth = true;
                if (currentMonthFilter !== null) {
                    if (currentMonthFilter === -1) {
                        matchesMonth = !c.birthday || !c.birthday.match(/(\d+)æœˆ/);
                    } else {
                        matchesMonth = c.birthday && parseInt(c.birthday.match(/(\d+)æœˆ/)?.[1]) === currentMonthFilter;
                    }
                }

                return matchesSearch && matchesFilter && matchesSkill && matchesMonth;
            });

            if (currentSkillFilter) {
                displayChars.sort((a, b) => {
                    const skA = a.skills.find(s => s.name === currentSkillFilter && !(viewOnly && s.secret))?.val || 0;
                    const skB = b.skills.find(s => s.name === currentSkillFilter && !(viewOnly && s.secret))?.val || 0;
                    return skB - skA;
                });
            } else {
                switch(sortMode) {
                    case 'newest': displayChars.sort((a,b) => b.addedAt - a.addedAt); break;
                    case 'oldest': displayChars.sort((a,b) => a.addedAt - b.addedAt); break;
                    case 'name': displayChars.sort((a,b) => (a.yomi || a.surname).localeCompare(b.yomi || b.surname, 'ja')); break;
                    case 'san': displayChars.sort((a,b) => (parseInt(b.stats.SAN)||0) - (parseInt(a.stats.SAN)||0)); break;
                }
            }

            let limit = itemsPerPage;
            if (viewMode === 'simple') {
                limit = 9999;
                const count = displayChars.length;
                const rootStyle = document.documentElement.style;
                
                if (count > 100) {
                    rootStyle.setProperty('--simple-col-min', '60px');
                    rootStyle.setProperty('--simple-icon-size', '50px');
                    rootStyle.setProperty('--simple-font-size', '0.6rem');
                } else if (count > 50) {
                    rootStyle.setProperty('--simple-col-min', '80px');
                    rootStyle.setProperty('--simple-icon-size', '70px');
                    rootStyle.setProperty('--simple-font-size', '0.7rem');
                } else {
                    rootStyle.setProperty('--simple-col-min', '100px');
                    rootStyle.setProperty('--simple-icon-size', '80px');
                    rootStyle.setProperty('--simple-font-size', '0.8rem');
                }
            }

            const totalPages = Math.ceil(displayChars.length / limit);
            if(currentPage > totalPages) currentPage = Math.max(1, totalPages);
            
            const charsToShow = focusedCharId 
                ? displayChars.filter(c => c.id === focusedCharId) 
                : displayChars.slice((currentPage - 1) * limit, currentPage * limit);

            list.innerHTML = "";
            
            // åŸ‹ã‚è¾¼ã¿SVGç”»åƒï¼ˆNo Imageç”¨ï¼‰
            const noImage = "data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='220' height='300' viewBox='0 0 220 300'%3e%3crect width='220' height='300' fill='%23f1f5f9'/%3e%3ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-weight='900' font-size='24' fill='%23cbd5e1'%3eNO IMAGE%3c/text%3e%3c/svg%3e";

            charsToShow.forEach(c => {
                const card = document.createElement('div');
                card.className = `card ${c.id === focusedCharId ? 'is-focused' : ''} ${c.isLost ? 'lost-mode' : ''}`;
                card.style.borderColor = c.isLost ? '#94a3b8' : c.color;
                card.style.borderLeftColor = c.isLost ? '#94a3b8' : c.color;
                if(viewMode === 'icons' && !focusedCharId) card.style.borderBottomColor = c.isLost ? '#94a3b8' : c.color;

                card.onclick = () => { if(!focusedCharId) jumpToChar(c.id); };

                const edClass = c.version === "7ç‰ˆ" ? "edition-tag-7" : "edition-tag-6";
                // ä¿®æ­£: æŠ€èƒ½ã‚½ãƒ¼ãƒˆã¾ãŸã¯æ­£æ°—åº¦ã‚½ãƒ¼ãƒˆæ™‚ã«å€¤ã‚’å¼·èª¿è¡¨ç¤º
                let highlightSkill = null;
                if (currentSkillFilter) {
                    highlightSkill = c.skills.find(s => s.name === currentSkillFilter);
                } else if (sortMode === 'san') {
                    // æ­£æ°—åº¦ã‚½ãƒ¼ãƒˆæ™‚
                    highlightSkill = { name: 'SAN', val: c.san || 0 };
                }

                let controlsHtml = '';
                if (isReadOnlyMode || isWebFetchMode) {
                     controlsHtml = `
                        <div class="card-controls flex items-center gap-2" onclick="event.stopPropagation();">
                             <button onclick="event.stopPropagation(); confirmShowRaw('${c.id}')" class="icon-btn hover:text-indigo-500" title="å…ƒãƒ‡ãƒ¼ã‚¿"><i class="fas fa-file-alt pointer-events-none"></i></button>
                        </div>
                     `;
                } else {
                     controlsHtml = `
                        <div class="card-controls admin-only persistent flex items-center gap-2" onclick="event.stopPropagation();">
                            <input type="color" value="${c.color}" onchange="event.stopPropagation(); updateColor('${c.id}', this.value)" class="color-picker-btn" title="è‰²å¤‰æ›´">
                            <button onclick="event.stopPropagation(); toggleLost('${c.id}')" class="icon-btn hover:text-rose-500" title="ãƒ­ã‚¹ãƒˆåˆ‡ã‚Šæ›¿ãˆ"><i class="fas fa-skull-crossbones pointer-events-none"></i></button>
                            <button onclick="event.stopPropagation(); showRawModal('${c.id}')" class="icon-btn hover:text-indigo-500" title="å…ƒãƒ‡ãƒ¼ã‚¿"><i class="fas fa-file-alt pointer-events-none"></i></button>
                            <button onclick="event.stopPropagation(); showConfirm('${c.id}')" class="icon-btn hover:text-rose-600" title="å‰Šé™¤"><i class="fas fa-trash-alt pointer-events-none"></i></button>
                        </div>
                    `;
                }

                // èª•ç”Ÿæ—¥ã®()å‰Šé™¤å‡¦ç†
                const bdayDisplay = (c.birthday || "??").replace(/\s*[ï¼ˆ\(].*?[ï¼‰\)]/g, '').trim();

                // è‰²ã®è¨ˆç®—
                const textColor = getTextColor(c.color);
                const isDarkBg = textColor === '#ffffff';
                const mutedColor = isDarkBg ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.6)';
                const badgeBg = isDarkBg ? 'rgba(255,255,255,0.2)' : 'rgba(0,0,0,0.05)';
                
                const visibleSkills = c.skills.filter(s => !(viewOnly && s.secret));

                card.innerHTML = `
                    <div class="lost-watermark">LOST</div>
                    ${controlsHtml}

                    <div class="header-section" style="background-color: ${c.color}; color: ${textColor};" onclick="if(!focusedCharId) jumpToChar('${c.id}')" style="cursor: pointer;">
                        <img src="${c.image || noImage}" 
                                class="image-preview" onclick="event.stopPropagation(); triggerImageUpload('${c.id}')">
                        <div class="info-container">
                            <div class="char-yomi text-[10px] font-black tracking-widest mb-1 uppercase w-full text-center truncate" style="color: ${mutedColor};">
                                <span class="editable-field" data-id="${c.id}" data-field="yomi">${c.yomi || '---'}</span>
                            </div>
                            <div class="char-name font-black leading-tight mb-2 w-full text-center truncate" title="${c.surname} ${c.givenName}" style="color: ${textColor};">
                                <span class="editable-field" data-id="${c.id}" data-field="surname">${c.surname}</span> 
                                <span class="editable-field" data-id="${c.id}" data-field="givenName">${c.givenName}</span>
                            </div>
                            <div class="flex flex-wrap gap-2 justify-center view-mode-list:justify-start focused-mode:justify-start tags-wrapper w-full overflow-hidden">
                                <div class="flex items-center gap-2 whitespace-nowrap overflow-hidden max-w-full justify-center">
                                    <span class="px-3 py-1 ${edClass} rounded-lg font-black text-sm whitespace-nowrap flex-shrink-0" style="border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">${c.version}</span>
                                    <span class="px-4 py-1 bg-slate-100 dark:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-lg text-theme-sub whitespace-nowrap overflow-hidden text-ellipsis" style="border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <span class="editable-field" data-id="${c.id}" data-field="age">${c.age}</span>æ­³ / 
                                        <span class="editable-field" data-id="${c.id}" data-field="gender">${c.gender}</span>
                                    </span>
                                </div>
                                <span class="px-4 py-1 rounded-lg font-black text-lg job-tag w-full text-center truncate text-white" style="background:${c.isLost ? '#94a3b8' : c.color}; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" title="${c.job}">
                                    <span class="editable-field" data-id="${c.id}" data-field="job">${c.job}</span>
                                </span>
                            </div>
                            <div class="mt-1 w-full text-xs font-bold flex items-center justify-center gap-1 whitespace-nowrap overflow-hidden" style="color: ${mutedColor};">
                                <span class="truncate" title="èª•ç”Ÿæ—¥: ${bdayDisplay}"><i class="fas fa-birthday-cake mr-0.5"></i>${bdayDisplay}</span>
                                <span class="mx-0.5">|</span>
                                <span class="truncate" title="èº«é•·/ä½“é‡: ${c.height}cm / ${c.weight}kg"><i class="fas fa-ruler-vertical mr-0.5"></i>${c.height || "??"}cm / <i class="fas fa-weight mr-0.5"></i>${c.weight || "??"}kg</span>
                            </div>

                            ${highlightSkill ? `
                                <div class="mt-4 px-4 py-2 rounded-xl flex justify-between items-center w-full highlight-val-box" style="background-color: ${badgeBg}; border: 1px solid ${isDarkBg ? 'rgba(255,255,255,0.3)' : 'rgba(0,0,0,0.1)'};">
                                    <span class="text-xs font-bold truncate flex-1 mr-2 highlight-val-label" style="color: ${mutedColor};">${highlightSkill.name}</span>
                                    <span class="text-xl font-black flex-shrink-0 highlight-val-text" style="color: ${textColor};">${highlightSkill.val}%</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <div class="mb-6">
                            <span class="text-[9px] text-theme-muted font-black block mb-2 uppercase tracking-widest">ä»£è¡¨ã‚·ãƒŠãƒªã‚ª</span>
                            <div class="p-4 rounded-xl italic text-sm font-bold text-theme-sub info-panel">
                                <span class="editable-field block w-full" data-id="${c.id}" data-field="scenario">${c.scenario || "æœªè¨˜å…¥"}</span>
                            </div>
                        </div>
                         <div class="mb-8">
                            <span class="text-[9px] text-theme-muted font-black block mb-2 uppercase tracking-widest">MEMO <i class="fas fa-sticky-note ml-1"></i></span>
                            <div class="p-4 rounded-xl italic text-sm font-bold text-theme-sub info-panel">
                                <span class="editable-field block w-full" data-id="${c.id}" data-field="memo">${c.memo || "ãƒ¡ãƒ¢ãªã—"}</span>
                            </div>
                        </div>
                        
                        <div class="stat-main-grid">
                            ${['STR','CON','POW','DEX','APP','SIZ','INT','EDU'].map(k => {
                                const val = parseInt(c.stats[k] || 0);
                                const isV7 = c.version === '7ç‰ˆ';
                                const subVal = isV7 ? Math.floor(val/5) : val*5;
                                return `
                                    <div class="stat-box border-${k.toLowerCase()}">
                                        <span class="stat-label">${k}</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="${c.id}" data-field="stats" data-key="${k}">${val}</span>
                                        <span class="stat-sub-val">(${subVal})</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        <div class="stat-sub-grid mb-8">
                            ${['HP','MP','SAN'].map(k => {
                                let val = k==='SAN' ? (c.stats.SAN || c.san || 0) : (c.stats[k] || c[k.toLowerCase()] || 0);
                                return `
                                    <div class="stat-box border-${k.toLowerCase()}">
                                        <span class="stat-label">${k}</span>
                                        <span class="stat-val editable-field force-dark-text" data-id="${c.id}" data-field="stats" data-key="${k}">${val}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>

                        <div class="skill-section">
                            <div class="flex justify-between items-end mb-3 border-b border-slate-100 dark:border-slate-800 pb-1">
                                <span class="text-[9px] text-theme-muted font-black uppercase tracking-widest">æŠ€èƒ½ä¸€è¦§ (ã‚¯ãƒªãƒƒã‚¯ã§ã‚½ãƒ¼ãƒˆ)</span>
                            </div>
                            <div class="skill-list">
                                ${visibleSkills.length > 0 ? visibleSkills.map((s) => `
                                    <div class="skill-item ${currentSkillFilter === s.name ? 'active-sort' : ''} ${s.secret ? 'opacity-60 border-rose-300' : ''}" onclick="event.stopPropagation(); filterBySkill('${s.name}')" title="${s.name}">
                                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                                            <button class="text-xs text-slate-300 hover:text-indigo-500 shrink-0" onclick="event.stopPropagation(); filterBySkill('${s.name}')" title="ã“ã®æŠ€èƒ½ã§ã‚½ãƒ¼ãƒˆ"><i class="fas fa-sort"></i></button>
                                            <span class="skill-name truncate dark:text-slate-300 force-dark-text">
                                                ${s.secret ? '<i class="fas fa-eye-slash text-rose-500 mr-1" title="é–²è¦§ç”¨ã§éè¡¨ç¤ºã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™"></i>' : ''}
                                                ${s.name}
                                            </span>
                                        </div>
                                        <div class="flex items-center shrink-0">
                                            <span class="${currentSkillFilter === s.name ? 'text-white' : 'text-indigo-500'} font-black mr-2">${s.val}%</span>
                                            ${viewOnly ? '' : `
                                            <div class="flex items-center gap-1.5 ml-2">
                                                <button class="text-[10px] text-slate-400 hover:text-rose-500 transition-colors" onclick="event.stopPropagation(); toggleSkillSecret('${c.id}', '${s.name}')" title="ãƒã‚¿ãƒãƒ¬é˜²æ­¢(é–²è¦§æ™‚éè¡¨ç¤º)"><i class="fas ${s.secret ? 'fa-eye-slash text-rose-500' : 'fa-eye'}"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('${c.id}', '${s.name}', -1)"><i class="fas fa-minus"></i></button>
                                                <button class="text-[10px] text-slate-400 hover:text-indigo-500 transition-colors" onclick="event.stopPropagation(); adjustSkill('${c.id}', '${s.name}', 1)"><i class="fas fa-plus"></i></button>
                                            </div>
                                            `}
                                        </div>
                                    </div>
                                `).join('') : '<p class="text-[10px] text-slate-300">æŠ€èƒ½ãªã—</p>'}
                            </div>
                        </div>
                    </div>
                `;
                list.appendChild(card);
            });

            bindEditableFields();
            updateSkillSelect();
            renderPagination(totalPages);
        }

        function renderPagination(totalPages) {
            const containers = [document.getElementById('paginationTop'), document.getElementById('paginationBottom')];
            containers.forEach(target => {
                if(!target) return;
                // ä¿®æ­£: å€‹åˆ¥è¡¨ç¤º(focusedCharIdã‚ã‚Š)ã®ã¨ãã¯ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’éš ã™
                if(totalPages <= 1 || viewMode === 'simple' || focusedCharId) { 
                    target.innerHTML = ''; 
                    target.classList.add('hidden');
                    return; 
                }
                target.classList.remove('hidden');
                target.innerHTML = `
                    <button onclick="changePage(-1)" ${currentPage===1?'disabled':''} class="page-btn"><</button>
                    <span class="page-info force-dark-text">Page ${currentPage} / ${totalPages}</span>
                    <button onclick="changePage(1)" ${currentPage===totalPages?'disabled':''} class="page-btn">></button>
                `;
                const list = document.getElementById('characterList');
                if(isCollapsed) target.classList.add('is-collapsed');
                else target.classList.remove('is-collapsed');
            });
        }

        function changePage(delta) {
            currentPage += delta;
            renderAll();
            document.getElementById('characterList').scrollIntoView({behavior:'smooth'});
        }

        function toggleSkillSecret(charId, skillName) {
            if(isReadOnlyMode || isWebFetchMode) return;
            const char = characters.find(c => c.id === charId);
            if(char && char.skills) {
                const skill = char.skills.find(s => s.name === skillName);
                if(skill) {
                    skill.secret = !skill.secret;
                    saveData();
                    renderAll();
                }
            }
        }

        function adjustSkill(charId, skillName, delta) {
            if(isReadOnlyMode || isWebFetchMode) return;
            const char = characters.find(c => c.id === charId);
            if(char && char.skills) {
                const skill = char.skills.find(s => s.name === skillName);
                if(skill) {
                    skill.val = Math.max(0, Math.min(99, skill.val + delta));
                    saveData();
                    renderAll();
                }
            }
        }

        function updateColor(id, val) {
            if(isReadOnlyMode || isWebFetchMode) return;
            const char = characters.find(c => c.id === id);
            if (char) { char.color = val; saveData(); renderAll(); renderCalendar(); }
        }

        function toggleLost(id) {
            if(isReadOnlyMode || isWebFetchMode) return;
            const char = characters.find(c => c.id === id);
            if(char) {
                char.isLost = !char.isLost;
                saveData();
                renderAll();
            }
        }

        function updateStats() {
            const total = characters.length;
            document.getElementById('stat-total').innerText = total;

            const lostCount = characters.filter(c => c.isLost).length;
            const lostElem = document.getElementById('stat-lost');
            if(lostElem) lostElem.innerText = lostCount;

            const viewOnly = isViewOnlyMode();

            // èº«é•·ãƒ‡ãƒ¼ã‚¿é›†è¨ˆç”¨
            let maleHeightSum = 0, maleCount = 0;
            let femaleHeightSum = 0, femaleCount = 0;

            const ageGroups = {"10ä»£": 0, "20ä»£": 0, "30ä»£": 0, "40ä»£+": 0, "ä¸æ˜": 0};
            
            // ã‚¸ãƒ§ãƒ–é›†è¨ˆ
            const jobCounts = {};
            
            characters.forEach(c => {
                // å¹´ä»£
                const ageStr = c.age || "??";
                const a = parseInt(ageStr.replace(/[^0-9]/g, ''));
                if (isNaN(a)) ageGroups["ä¸æ˜"]++;
                else if (a < 20) ageGroups["10ä»£"]++;
                else if (a < 30) ageGroups["20ä»£"]++;
                else if (a < 40) ageGroups["30ä»£"]++;
                else ageGroups["40ä»£+"]++;

                // ã‚¸ãƒ§ãƒ–
                if(c.job && c.job !== 'ä¸æ˜') {
                    const normalizedJob = c.job.split(/[ï¼ˆ(\sã€€\/ï¼]/)[0];
                    if (normalizedJob) {
                        jobCounts[normalizedJob] = (jobCounts[normalizedJob] || 0) + 1;
                    }
                }

                // èº«é•·é›†è¨ˆ
                const hVal = parseFloat((c.height || "").replace(/[^0-9.]/g, ''));
                if (!isNaN(hVal) && hVal > 0) {
                    let g = c.gender || "ä¸æ˜";
                    if(g.includes("å¥³")) {
                        femaleHeightSum += hVal;
                        femaleCount++;
                    } else if(g.includes("ç”·")) {
                        maleHeightSum += hVal;
                        maleCount++;
                    }
                }
            });

            document.getElementById('stat-ages').innerHTML = Object.entries(ageGroups).map(([k, v]) => `
                <div class="flex items-center gap-2 text-[9px] font-black dark:text-slate-300">
                    <span class="w-8 shrink-0">${k}</span>
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 h-1 rounded-full"><div class="bg-indigo-400 h-full" style="width:${total>0?(v/total*100):0}%"></div></div>
                    <span class="w-4 text-right">${v}</span>
                </div>
            `).join('');

            const versions = {"6ç‰ˆ": 0, "7ç‰ˆ": 0};
            characters.forEach(c => { if(versions[c.version] !== undefined) versions[c.version]++; });
            document.getElementById('stat-versions').innerHTML = Object.entries(versions).map(([k, v]) => `
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">${k}</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full ${k==='7ç‰ˆ'?'bg-green-100 text-green-600':'bg-blue-100 text-blue-600'}">${v}</span>
                </div>
            `).join('');

            const genders = {"ç”·æ€§": 0, "å¥³æ€§": 0, "ä»–": 0};
            characters.forEach(c => { 
                let g = c.gender || "ä¸æ˜";
                if(g.includes("å¥³")) g = "å¥³æ€§"; else if(g.includes("ç”·")) g = "ç”·æ€§"; else g = "ä»–";
                genders[g]++; 
            });
            document.getElementById('stat-gender').innerHTML = Object.entries(genders).map(([k, v]) => `
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">${k}</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full ${k==='å¥³æ€§'?'bg-pink-100 text-pink-600':k==='ç”·æ€§'?'bg-sky-100 text-sky-600':'bg-slate-100 text-slate-600'}">${v}</span>
                </div>
            `).join('');

            const sanGroups = {"å®‰å®š(70+)": 0, "æ³¨æ„(40-69)": 0, "å±é™º(0-39)": 0};
            characters.forEach(c => {
                const s = parseInt(c.san || 0);
                if (s >= 70) sanGroups["å®‰å®š(70+)"]++; else if (s >= 40) sanGroups["æ³¨æ„(40-69)"]++; else sanGroups["å±é™º(0-39)"]++;
            });
            document.getElementById('stat-san').innerHTML = Object.entries(sanGroups).map(([k, v]) => `
                <div class="stat-item-pop">
                    <span class="text-[9px] font-black dark:text-slate-300">${k}</span>
                    <span class="text-xs font-black px-2 py-0.5 rounded-full ${k.includes('å®‰å®š')?'bg-indigo-100 text-indigo-600':k.includes('æ³¨æ„')?'bg-slate-100 text-slate-600':'bg-rose-100 text-rose-600'}">${v}</span>
                </div>
            `).join('');

            // ã‚¸ãƒ§ãƒ–TOP3ã®æ¦‚è¦è¡¨ç¤º
            const topJobs = Object.entries(jobCounts).sort((a,b) => b[1]-a[1]).slice(0,1);
            const topJobText = topJobs.length > 0 ? `${topJobs[0][0]} (${topJobs[0][1]}å)` : "ãƒ‡ãƒ¼ã‚¿ãªã—";
            document.getElementById('stat-jobs-summary').innerHTML = `<div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: ${topJobText}</div>`;

            // èƒ½åŠ›å€¤å¹³å‡TOP3ã®æ¦‚è¦è¡¨ç¤º
            const targetStats = ['STR','CON','POW','DEX','APP','SIZ','INT','EDU'];
            const topStatChar = characters.map(c => {
                let sum = 0;
                targetStats.forEach(k => { 
                    let val = parseInt(c.stats[k] || 0);
                    // 6ç‰ˆã®å ´åˆã¯5å€ã—ã¦7ç‰ˆåŸºæº–ã«åˆã‚ã›ã‚‹ï¼ˆæ¯”è¼ƒç”¨ï¼‰
                    if (c.version === '6ç‰ˆ') val *= 5;
                    sum += val;
                });
                return { name: c.surname, val: (sum/8) };
            }).sort((a,b) => b.val - a.val)[0];
            // è¡¨ç¤ºã¯6ç‰ˆåŸºæº–ï¼ˆ/5ï¼‰ã§è¡Œã†
            const topStatText = topStatChar ? `${topStatChar.name} (${(topStatChar.val / 5).toFixed(1)})` : "ãƒ‡ãƒ¼ã‚¿ãªã—";
            document.getElementById('stat-top3-summary').innerHTML = `<div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: ${topStatText}</div>`;

            // èº«é•·å¹³å‡ã®æ¦‚è¦è¡¨ç¤º
            const maleAvg = maleCount > 0 ? (maleHeightSum / maleCount).toFixed(1) : "-";
            const femaleAvg = femaleCount > 0 ? (femaleHeightSum / femaleCount).toFixed(1) : "-";
            document.getElementById('stat-height-summary').innerHTML = `
                <div class="flex justify-around text-[10px] font-bold text-slate-500 dark:text-slate-400 mt-1">
                    <span><i class="fas fa-mars text-sky-500 mr-1"></i>Avg: ${maleAvg}cm</span>
                    <span><i class="fas fa-venus text-pink-500 mr-1"></i>Avg: ${femaleAvg}cm</span>
                </div>
            `;

            // ç­‹è‚‰ç•ªä»˜ã®æ¦‚è¦è¡¨ç¤º (ä¿®æ­£: 6ç‰ˆæ··åŒè¨ˆç®—)
            const topMuscle = characters.map(c => {
                let s = parseInt(c.stats.STR || 0);
                let z = parseInt(c.stats.SIZ || 0);
                
                // 6ç‰ˆã®å ´åˆã¯5å€ã—ã¦7ç‰ˆåŸºæº–ã«åˆã‚ã›ã‚‹ï¼ˆæ··åŒé›†è¨ˆï¼‰
                if (c.version === '6ç‰ˆ') {
                    s *= 5;
                    z *= 5;
                }
                
                return { name: c.surname, val: s + z };
            }).sort((a,b) => b.val - a.val)[0];
            // è¡¨ç¤ºã¯6ç‰ˆåŸºæº–ï¼ˆ/5ï¼‰ã§è¡Œã†
            const topMuscleText = topMuscle ? `${topMuscle.name} (${Math.floor(topMuscle.val / 5)})` : "ãƒ‡ãƒ¼ã‚¿ãªã—";
            document.getElementById('stat-muscle-summary').innerHTML = `<div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: ${topMuscleText}</div>`;

            // æ¢ç´¢ã®åŒ ã®æ¦‚è¦è¡¨ç¤º
            const topExpert = characters.map(c => {
                let sum = 0;
                ['ç›®æ˜Ÿ', 'èãè€³', 'å›³æ›¸é¤¨'].forEach(sn => {
                    const sk = c.skills.find(s => s.name === sn);
                    if(sk && !(viewOnly && sk.secret)) sum += sk.val;
                });
                return { name: c.surname, val: sum };
            }).sort((a,b) => b.val - a.val)[0];
            const topExpertText = topExpert && topExpert.val > 0 ? `${topExpert.name} (${topExpert.val})` : "ãƒ‡ãƒ¼ã‚¿ãªã—";
            document.getElementById('stat-expert-summary').innerHTML = `<div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: ${topExpertText}</div>`;

            // äººæ°—æŠ€èƒ½ã®æ¦‚è¦è¡¨ç¤º (æ–°è¦è¿½åŠ )
            const popularSkillCounts = {};
            const excludeSkills = ['ç›®æ˜Ÿ', 'èãè€³', 'å›³æ›¸é¤¨', 'å›é¿', 'æ¯å›½èª']; 
            characters.forEach(c => {
                if (c.skills && c.skills.length > 0) {
                    const uniqueSkills = new Set();
                    c.skills.forEach(s => {
                        if (!(viewOnly && s.secret)) uniqueSkills.add(s.name);
                    });
                    uniqueSkills.forEach(skillName => {
                        const isExcluded = excludeSkills.some(ex => skillName.includes(ex));
                        if (!isExcluded) {
                            popularSkillCounts[skillName] = (popularSkillCounts[skillName] || 0) + 1;
                        }
                    });
                }
            });
            const topPopularSkills = Object.entries(popularSkillCounts).sort((a,b) => b[1]-a[1]).slice(0, 1);
            const topPopularSkillText = topPopularSkills.length > 0 ? `${topPopularSkills[0][0]} (${topPopularSkills[0][1]}å)` : "ãƒ‡ãƒ¼ã‚¿ãªã—";
            document.getElementById('stat-popular-skills-summary').innerHTML = `<div class="text-xs font-bold text-slate-600 dark:text-slate-300 text-center mt-1">TOP: ${topPopularSkillText}</div>`;

            const monthCounts = Array(12).fill(0);
            let unassignedMonthCount = 0;
            characters.forEach(c => { 
                const bday = c.birthday || "";
                const m = bday.match(/(\d+)æœˆ/); 
                if (m) {
                    monthCounts[parseInt(m[1]) - 1]++; 
                } else {
                    unassignedMonthCount++;
                }
            });
            document.getElementById('stat-months').innerHTML = monthCounts.map((count, i) => `
                <div onclick="filterByMonth(${i + 1})" class="p-3 text-center rounded-2xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 flex flex-col items-center justify-center h-20 cursor-pointer hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors">
                    <div class="text-xs text-slate-400 font-black mb-1">${i+1}æœˆ</div>
                    <div class="text-2xl font-black ${count > 0 ? 'text-indigo-500' : 'text-slate-200 dark:text-slate-700'}">${count}</div>
                </div>
            `).join('');
            
            document.getElementById('stat-unassigned-month').innerHTML = `
                <div onclick="filterByMonth(-1)" class="px-4 py-2 rounded-xl bg-slate-50 dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors flex items-center gap-2 shadow-sm">
                    <span class="text-xs text-slate-400 font-black"><i class="fas fa-question-circle mr-1"></i>æœªè¨­å®š</span>
                    <span class="text-sm font-black ${unassignedMonthCount > 0 ? 'text-slate-600 dark:text-slate-300' : 'text-slate-200 dark:text-slate-700'}">${unassignedMonthCount}</span>
                </div>
            `;
            
            document.getElementById('stat-months').className = "grid grid-cols-4 gap-3 mb-2";
        }

        // æ±ç”¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºé–¢æ•°
        function showRankingModal(type) {
            const container = document.getElementById('rankingContent');
            const titleEl = document.getElementById('rankingTitle');
            const viewOnly = isViewOnlyMode();
            container.innerHTML = '';
            container.className = "flex flex-col gap-2 pb-4 flex-1 overflow-y-auto"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ç¸¦ãƒªã‚¹ãƒˆ
            
            const crowns = ["text-yellow-500", "text-slate-400", "text-amber-700"];

            if (type === 'stats') {
                titleEl.innerHTML = '<i class="fas fa-chart-bar text-indigo-500 mr-2"></i>ç·åˆèƒ½åŠ›å€¤å¹³å‡ãƒ©ãƒ³ã‚­ãƒ³ã‚° (TOP10)';
                const keys = ['STR','CON','POW','DEX','APP','SIZ','INT','EDU'];
                container.className = "ranking-grid pb-4 flex-1 overflow-y-auto"; // ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆé©ç”¨
                
                keys.forEach(key => {
                    const sorted = characters.map(c => {
                        const rawVal = parseInt(c.stats[key] || 0);
                        const compVal = (c.version === '7ç‰ˆ') ? rawVal : rawVal * 5;
                        return { id: c.id, name: `${c.surname} ${c.givenName}`, raw: rawVal, comp: compVal, color: c.color };
                    }).sort((a,b) => b.comp - a.comp).slice(0,10);

                    const card = document.createElement('div');
                    card.className = "bg-slate-50 dark:bg-slate-900 p-3 rounded-2xl border border-slate-100 dark:border-slate-700 h-full flex flex-col";
                    
                    let listHtml = sorted.map((item, i) => {
                        const displayVal = Math.floor(item.comp / 5);
                        const isTop3 = i < 3;
                        const rowClass = isTop3 
                            ? "flex items-center justify-between text-xs py-1 border-b border-slate-100 dark:border-slate-800" 
                            : "flex items-center justify-between text-[10px] py-0.5 border-b border-slate-100 dark:border-slate-800 last:border-0 opacity-80";
                        let rankIcon = (i < 3) ? `<i class="fas fa-crown ${crowns[i]} text-[10px] w-4 text-center"></i>` : `<span class="w-4 text-center font-bold text-slate-300">${i + 1}.</span>`;
                        
                        return `
                        <div class="${rowClass} cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors rounded px-1" onclick="jumpToChar('${item.id}'); closeRankingModal();" title="${item.name}">
                            <div class="flex items-center gap-1 overflow-hidden w-full mr-2">
                                ${rankIcon}
                                <span class="truncate font-bold dark:text-slate-300" style="color:${item.color}">${item.name}</span>
                            </div>
                            <span class="font-black ${isTop3 ? 'text-slate-500' : 'text-slate-400'} dark:text-slate-400 shrink-0">${displayVal}</span>
                        </div>
                    `}).join('');

                    if(sorted.length === 0) listHtml = '<span class="text-[10px] text-slate-300">ãƒ‡ãƒ¼ã‚¿ãªã—</span>';

                    card.innerHTML = `
                        <div class="text-xs font-black text-center mb-2 pb-1 border-b-2 border-indigo-100 dark:border-slate-700 text-indigo-400 sticky top-0 bg-slate-50 dark:bg-slate-900 z-10">${key}</div>
                        <div class="flex flex-col gap-0.5 flex-1 overflow-y-auto" style="max-height: 300px;">
                            ${listHtml}
                        </div>
                    `;
                    container.appendChild(card);
                });

            } else if (type === 'job') {
                titleEl.innerHTML = '<i class="fas fa-briefcase text-emerald-500 mr-2"></i>è·æ¥­åˆ†å¸ƒãƒ©ãƒ³ã‚­ãƒ³ã‚°';
                
                const jobCounts = {};
                characters.forEach(c => { 
                    if(c.job && c.job !== 'ä¸æ˜') {
                        const normalizedJob = c.job.split(/[ï¼ˆ(\sã€€\/ï¼]/)[0];
                        if (normalizedJob) jobCounts[normalizedJob] = (jobCounts[normalizedJob] || 0) + 1;
                    }
                });
                const sortedJobs = Object.entries(jobCounts).sort((a,b) => b[1]-a[1]);
                
                container.innerHTML = sortedJobs.map((j, i) => `
                    <div class="flex items-center justify-between p-3 rounded-xl mb-2 ranking-list-item">
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-black w-6 text-slate-400 text-center">${i+1}.</span>
                            <span class="font-bold">${j[0]}</span>
                        </div>
                        <span class="font-black text-indigo-500 text-lg">${j[1]}<span class="text-xs ml-1 opacity-70">å</span></span>
                    </div>
                `).join('') || '<p class="text-center text-slate-400 py-4">ãƒ‡ãƒ¼ã‚¿ãªã—</p>';

            } else if (type === 'height') {
                titleEl.innerHTML = '<i class="fas fa-ruler-vertical text-rose-500 mr-2"></i>èº«é•·ãƒ‡ãƒ¼ã‚¿è©³ç´°';
                container.className = "flex flex-col gap-6 pb-4 flex-1 overflow-y-auto"; 

                // ãƒ‡ãƒ¼ã‚¿æº–å‚™
                let males = [], females = [];
                characters.forEach(c => {
                    const hVal = parseFloat((c.height || "").replace(/[^0-9.]/g, ''));
                    if (!isNaN(hVal) && hVal > 0) {
                        let item = { id: c.id, name: `${c.surname} ${c.givenName}`, height: hVal, color: c.color };
                        if ((c.gender || "").includes("å¥³")) females.push(item);
                        else if ((c.gender || "").includes("ç”·")) males.push(item);
                    }
                });

                // ã‚½ãƒ¼ãƒˆï¼ˆé«˜ã„é †ï¼‰
                males.sort((a,b) => b.height - a.height);
                females.sort((a,b) => b.height - a.height);

                // å¹³å‡è¨ˆç®—
                const calcAvg = (arr) => arr.length > 0 ? (arr.reduce((a,b)=>a+b.height,0)/arr.length).toFixed(1) : "-";
                
                const renderHeightRank = (list, title, iconClass, colorClass) => {
                    const top3 = list.slice(0, 3);
                    const avg = calcAvg(list);
                    let itemsHtml = top3.map((item, i) => `
                        <div class="flex items-center justify-between p-2 rounded-lg mb-1 cursor-pointer ranking-list-item" onclick="jumpToChar('${item.id}'); closeRankingModal();">
                            <div class="flex items-center gap-2 overflow-hidden">
                                <i class="fas fa-crown ${crowns[i]} text-xs w-4 text-center"></i>
                                <span class="text-sm font-bold truncate" style="color:${item.color}">${item.name}</span>
                            </div>
                            <span class="font-black text-sm text-slate-500 dark:text-slate-400">${item.height}cm</span>
                        </div>
                    `).join('') || '<div class="text-xs text-slate-400 text-center py-2">ãƒ‡ãƒ¼ã‚¿ãªã—</div>';

                    return `
                        <div class="bg-slate-50 dark:bg-slate-900 p-4 rounded-2xl border border-slate-100 dark:border-slate-700">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-black text-sm ${colorClass} flex items-center"><i class="${iconClass} mr-2"></i>${title}</h4>
                                <div class="px-3 py-1 bg-white dark:bg-slate-800 rounded-lg text-xs font-bold shadow-sm border border-slate-100 dark:border-slate-700">
                                    <span class="text-slate-400 mr-1">å¹³å‡:</span><span class="${colorClass} text-base">${avg}</span>cm
                                </div>
                            </div>
                            <div>
                                <div class="text-[10px] font-bold text-slate-400 mb-1 ml-1">é«˜èº«é•· TOP3</div>
                                ${itemsHtml}
                            </div>
                        </div>
                    `;
                };

                container.innerHTML = `
                    ${renderHeightRank(males, "ç”·æ€§", "fas fa-mars", "text-sky-500")}
                    ${renderHeightRank(females, "å¥³æ€§", "fas fa-venus", "text-pink-500")}
                `;
            } else if (type === 'muscle') {
                titleEl.innerHTML = '<i class="fas fa-dumbbell text-slate-500 mr-2"></i>ç­‹è‚‰ç•ªä»˜ (STR+SIZ) TOP10';
                
                const sorted = characters.map(c => {
                    let s = parseInt(c.stats.STR || 0);
                    let z = parseInt(c.stats.SIZ || 0);
                    // 6ç‰ˆã®å ´åˆã¯5å€ã—ã¦7ç‰ˆåŸºæº–ã«åˆã‚ã›ã‚‹ï¼ˆæ¯”è¼ƒç”¨ï¼‰
                    if (c.version === '6ç‰ˆ') {
                        s *= 5;
                        z *= 5;
                    }
                    return { id: c.id, name: `${c.surname} ${c.givenName}`, val: s + z, color: c.color };
                }).sort((a,b) => b.val - a.val).slice(0, 10);

                container.innerHTML = sorted.map((item, i) => {
                    // è¡¨ç¤ºç”¨: 6ç‰ˆåŸºæº–(/5)ã«åˆã‚ã›ã‚‹
                    const displayVal = Math.floor(item.val / 5);
                    let rankIcon = (i < 3) ? `<i class="fas fa-crown ${crowns[i]} text-sm w-6 text-center"></i>` : `<span class="w-6 text-center font-bold text-slate-300">${i + 1}.</span>`;
                    return `
                    <div class="flex items-center justify-between p-3 rounded-xl mb-2 ranking-list-item" onclick="jumpToChar('${item.id}'); closeRankingModal();">
                        <div class="flex items-center gap-3">
                            ${rankIcon}
                            <span class="font-bold" style="color:${item.color}">${item.name}</span>
                        </div>
                        <span class="font-black text-slate-500 dark:text-slate-400 text-lg">${displayVal}</span>
                    </div>
                `}).join('') || '<p class="text-center text-slate-400 py-4">ãƒ‡ãƒ¼ã‚¿ãªã—</p>';

            } else if (type === 'expert') {
                titleEl.innerHTML = '<i class="fas fa-search text-amber-500 mr-2"></i>æ¢ç´¢ã®åŒ  (ç›®æ˜Ÿ+èãè€³+å›³æ›¸é¤¨) TOP10';
                
                const sorted = characters.map(c => {
                    let sum = 0;
                    ['ç›®æ˜Ÿ', 'èãè€³', 'å›³æ›¸é¤¨'].forEach(sn => {
                        const sk = c.skills.find(s => s.name === sn);
                        if(sk && !(viewOnly && sk.secret)) sum += sk.val;
                    });
                    return { id: c.id, name: `${c.surname} ${c.givenName}`, val: sum, color: c.color };
                }).sort((a,b) => b.val - a.val).slice(0, 10);

                container.innerHTML = sorted.map((item, i) => {
                    if(item.val === 0) return '';
                    let rankIcon = (i < 3) ? `<i class="fas fa-crown ${crowns[i]} text-sm w-6 text-center"></i>` : `<span class="w-6 text-center font-bold text-slate-300">${i + 1}.</span>`;
                    return `
                    <div class="flex items-center justify-between p-3 rounded-xl mb-2 ranking-list-item" onclick="jumpToChar('${item.id}'); closeRankingModal();">
                        <div class="flex items-center gap-3">
                            ${rankIcon}
                            <span class="font-bold" style="color:${item.color}">${item.name}</span>
                        </div>
                        <span class="font-black text-amber-500 text-lg">${item.val}</span>
                    </div>
                `}).join('') || '<p class="text-center text-slate-400 py-4">ãƒ‡ãƒ¼ã‚¿ãªã—</p>';
            } else if (type === 'popular_skills') {
                titleEl.innerHTML = '<i class="fas fa-star text-yellow-400 mr-2"></i>äººæ°—æŠ€èƒ½ãƒ©ãƒ³ã‚­ãƒ³ã‚° TOP10';
                
                const skillCounts = {};
                const excludeSkills = ['ç›®æ˜Ÿ', 'èãè€³', 'å›³æ›¸é¤¨', 'å›é¿', 'æ¯å›½èª']; 
                characters.forEach(c => {
                    if (c.skills && c.skills.length > 0) {
                        const uniqueSkills = new Set();
                        c.skills.forEach(s => {
                            if (!(viewOnly && s.secret)) uniqueSkills.add(s.name);
                        });
                        uniqueSkills.forEach(skillName => {
                            const isExcluded = excludeSkills.some(ex => skillName.includes(ex));
                            if (!isExcluded) {
                                skillCounts[skillName] = (skillCounts[skillName] || 0) + 1;
                            }
                        });
                    }
                });
                
                const sortedSkills = Object.entries(skillCounts).sort((a,b) => b[1]-a[1]).slice(0, 10);
                
                container.innerHTML = sortedSkills.map((item, i) => {
                    let rankIcon = (i < 3) ? `<i class="fas fa-crown ${crowns[i]} text-sm w-6 text-center"></i>` : `<span class="w-6 text-center font-bold text-slate-300">${i + 1}.</span>`;
                    return `
                    <div class="flex items-center justify-between p-3 rounded-xl mb-2 ranking-list-item cursor-pointer" onclick="filterBySkill('${item[0]}'); closeRankingModal();" title="ã“ã®æŠ€èƒ½ã§çµã‚Šè¾¼ã‚€">
                        <div class="flex items-center gap-3">
                            ${rankIcon}
                            <span class="font-bold">${item[0]}</span>
                        </div>
                        <span class="font-black text-indigo-500 text-lg">${item[1]}<span class="text-xs ml-1 opacity-70">å</span></span>
                    </div>
                    `
                }).join('') || '<p class="text-center text-slate-400 py-4">ãƒ‡ãƒ¼ã‚¿ãªã—</p>';
                
                container.innerHTML += `<p class="text-[10px] text-slate-400 text-center mt-2">â€»ç›®æ˜Ÿã€èãè€³ã€å›³æ›¸é¤¨ã€å›é¿ã€æ¯å›½èªã¯é™¤å¤–ã—ã¦ã„ã¾ã™<br>â€»ã‚¯ãƒªãƒƒã‚¯ã§ãã®æŠ€èƒ½ã‚’æŒã¤æ¢ç´¢è€…ã‚’çµã‚Šè¾¼ã‚ã¾ã™</p>`;
            }

            document.getElementById('rankingModal').style.display = 'flex';
        }
        function closeRankingModal() { document.getElementById('rankingModal').style.display = 'none'; }

        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = "";
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            document.getElementById('calendar-title').innerText = `${currentYear}å¹´ ${currentMonth + 1}æœˆ`;
            for (let i = 0; i < firstDay; i++) grid.appendChild(Object.assign(document.createElement('div'), { className: "calendar-day bg-slate-50/20 dark:bg-slate-900/20" }));
            for (let d = 1; d <= daysInMonth; d++) {
                const dayBox = Object.assign(document.createElement('div'), { className: "calendar-day border-t border-l border-slate-100 dark:border-slate-800" });
                dayBox.innerHTML = `<span class="font-black text-slate-300 dark:text-slate-600 force-dark-text-muted">${d}</span>`;
                characters.forEach(c => {
                    const bday = c.birthday || "";
                    const m = bday.match(/(\d+)æœˆ(\d+)æ—¥/);
                    if (m && parseInt(m[1]) === currentMonth+1 && parseInt(m[2]) === d) {
                        const tag = Object.assign(document.createElement('div'), { 
                            className: "bday-tag",
                            innerText: `${c.surname}`,
                            onclick: () => jumpToChar(c.id)
                        });
                        tag.style.borderColor = c.color;
                        tag.style.color = c.color;
                        tag.style.backgroundColor = c.color + '15'; 
                        dayBox.appendChild(tag);
                    }
                });
                grid.appendChild(dayBox);
            }
        }

        function changeMonth(delta) {
            currentMonth += delta;
            if(currentMonth > 11) { currentMonth = 0; currentYear++; }
            if(currentMonth < 0) { currentMonth = 11; currentYear--; }
            renderCalendar();
        }

        function bindEditableFields() {
            if(isReadOnlyMode || isWebFetchMode || isLocked) return;
            document.querySelectorAll('.editable-field').forEach(el => {
                if(el.dataset.bound) return;
                el.dataset.bound = "true";
                el.onclick = (e) => {
                    e.stopPropagation();
                    const id = el.dataset.id;
                    const field = el.dataset.field;
                    const key = el.dataset.key; // statsã®å ´åˆ
                    
                    const char = characters.find(c => c.id === id);
                    if(!char) return;

                    let currentVal = "";
                    if(field === "stats") currentVal = char.stats[key];
                    else currentVal = char[field];

                    const newVal = prompt(`ã€Œ${field}${key?':'+key:''}ã€ã‚’ç·¨é›†`, currentVal);
                    if(newVal !== null) {
                        if(field === "stats") char.stats[key] = newVal;
                        else char[field] = newVal;
                        
                        // æ•°å€¤æ›´æ–°æ™‚ã®é€£å‹•
                        if(key === "STR" && parseInt(newVal) > 25) char.version = "7ç‰ˆ";
                        if(key === "STR" && parseInt(newVal) <= 25 && parseInt(newVal) > 0) char.version = "6ç‰ˆ";
                        
                        saveData();
                        updateStats();
                        renderAll();
                        renderCalendar();
                    }
                };
            });
        }

        function jumpToChar(id) {
            focusedCharId = id;
            renderAll();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function resetFocus() {
            focusedCharId = null;
            renderAll();
            const list = document.getElementById('characterList');
            if(list && !isCollapsed) list.scrollIntoView({ behavior: 'smooth' });
        }
        
        // --- Image Handling ---
        function triggerImageUpload(id) {
            if(isReadOnlyMode || isWebFetchMode || isLocked) return;
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = e => {
                const file = e.target.files[0];
                if(file) {
                    const reader = new FileReader();
                    reader.onload = evt => {
                        const char = characters.find(c => c.id === id);
                        if(char) {
                            resizeImage(evt.target.result, 300, 300, (resized) => {
                                char.image = resized;
                                saveData();
                                renderAll();
                            });
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }
        
        function resizeImage(base64Str, maxWidth, maxHeight, callback) {
            const img = new Image();
            img.src = base64Str;
            img.onload = () => {
                let w = img.width;
                let h = img.height;
                if(w > maxWidth) { h *= maxWidth/w; w = maxWidth; }
                if(h > maxHeight) { w *= maxHeight/h; h = maxHeight; }
                
                const canvas = document.createElement('canvas');
                canvas.width = w;
                canvas.height = h;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, w, h);
                callback(canvas.toDataURL('image/webp', 0.8));
            };
        }

        function compressAllImages() {
            if(!confirm("å…¨ã¦ã®ç”»åƒã‚’ãƒªã‚µã‚¤ã‚º(300px)ã—ã¦å®¹é‡ã‚’ç¯€ç´„ã—ã¾ã™ã‹ï¼Ÿ\nç”»è³ªãŒä½ä¸‹ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚")) return;
            let processed = 0;
            if(characters.length === 0) return;

            const processNext = (idx) => {
                if(idx >= characters.length) {
                    saveData();
                    renderAll();
                    alert("å®Œäº†ã—ã¾ã—ãŸ");
                    return;
                }
                const c = characters[idx];
                if(c.image && c.image.length > 50000) { // ã‚ã‚‹ç¨‹åº¦å¤§ãã„å ´åˆã®ã¿
                    resizeImage(c.image, 300, 300, (resized) => {
                        c.image = resized;
                        processNext(idx + 1);
                    });
                } else {
                    processNext(idx + 1);
                }
            };
            processNext(0);
        }

        // --- Raw Data View ---
        function showRawModal(id) {
            if(!confirm("å…ƒãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™ã‹ï¼Ÿ")) return;
            const char = characters.find(c => c.id === id);
            if(char) {
                document.getElementById('rawTextArea').textContent = char.rawText || JSON.stringify(char, null, 2);
                document.getElementById('rawTextModal').style.display = 'flex';
            }
        }
        // é–²è¦§ãƒ¢ãƒ¼ãƒ‰ç”¨: ç¢ºèªãªã—ã§è¡¨ç¤º -> ä¿®æ­£: ã“ã“ã«ã‚‚ç¢ºèªã‚’è¿½åŠ 
        function confirmShowRaw(id) { 
            if(!confirm("å…ƒãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™ã‹ï¼Ÿ")) return;
            const char = characters.find(c => c.id === id);
            if(char) {
                document.getElementById('rawTextArea').textContent = char.rawText || JSON.stringify(char, null, 2);
                document.getElementById('rawTextModal').style.display = 'flex';
            }
        }
        function closeRawModal() { document.getElementById('rawTextModal').style.display = 'none'; }

        // --- Delete Confirmation ---
        let deleteTargetId = null;
        function showConfirm(id) {
            deleteTargetId = id;
            const msg = document.getElementById('confirmMessage');
            if(id === 'all') {
                msg.innerText = "å…¨ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã€‚\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ";
            } else {
                const c = characters.find(x => x.id === id);
                msg.innerText = `ã€Œ${c.surname} ${c.givenName}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
            }
            document.getElementById('confirmModal').style.display = 'flex';
        }
        function closeConfirm() {
            document.getElementById('confirmModal').style.display = 'none';
            deleteTargetId = null;
        }
        
        document.getElementById('confirmExecBtn').onclick = () => {
            if(deleteTargetId === 'all') {
                characters = [];
            } else if(deleteTargetId) {
                characters = characters.filter(c => c.id !== deleteTargetId);
            }
            saveData();
            updateStats();
            renderAll();
            renderCalendar();
            closeConfirm();
        };

        // --- Initial Load ---
        // WEB_FETCH_LOGIC_START
        window.addEventListener('load', async () => {
            if(isWebFetchMode) {
                try {
                    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¹ã‚¿ãƒ¼ã‚’ä»˜ä¸ã—ã¦å¸¸ã«æœ€æ–°ã® data.json ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ä¿®æ­£
                    const res = await fetch('data.json?t=' + new Date().getTime());
                    if(res.ok) {
                        characters = await res.json();
                        characters.forEach(c => {
                            // é‡è¤‡æŠ€èƒ½ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                            if (c.skills) {
                                const uniqueMap = {};
                                c.skills.forEach(s => {
                                    uniqueMap[s.name] = uniqueMap[s.name] ? Math.max(uniqueMap[s.name], s.val) : s.val;
                                });
                                c.skills = Object.keys(uniqueMap).map(name => ({ name, val: uniqueMap[name] }));
                            }
                        });
                        updateStats();
                        renderAll();
                        renderCalendar();
                    } else {
                        console.error('data.json not found');
                    }
                } catch(e) { console.error(e); }
            } else {
                loadData();
            }
            // ãƒ†ãƒ¼ãƒã®å¾©å…ƒ
            const savedTheme = localStorage.getItem('coc_db_theme');
            if(savedTheme === 'dark') {
                isDarkMode = true;
                applyDarkMode();
            }
        });
        // WEB_FETCH_LOGIC_END

    </script>

</body></html>